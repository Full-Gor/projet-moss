{% extends 'base.html.twig' %}

{% block title %}Test de base de donn√©es
{% endblock %}

{% block body %}
	<div class="container mt-5">
		<div class="row">
			<div class="col-md-8 offset-md-2">
				<div class="card">
					<div class="card-header">
						<h3>üß™ Test de connexion √† la base de donn√©es</h3>
					</div>
					<div class="card-body">
						<div class="alert alert-{{ status == 'success' ? 'success' : 'danger' }}">
							<strong>Statut :</strong>
							{{ message }}
						</div>

						<div class="row">
							<div class="col-md-6">
								<h5>Informations syst√®me</h5>
								<ul class="list-unstyled">
									<li>
										<strong>Timestamp :</strong>
										{{ timestamp|date('d/m/Y H:i:s') }}</li>
									<li>
										<strong>Statut :</strong>
										<span class="badge bg-{{ status == 'success' ? 'success' : 'danger' }}">
											{{ status|upper }}
										</span>
									</li>
								</ul>
							</div>
							<div class="col-md-6">
								<h5>Actions</h5>
								<form method="POST" action="{{ path('app_test_ajouter') }}" class="d-inline">
									<button type="submit" class="btn btn-primary">
										Ajouter un log de test
									</button>
								</form>
								<a href="{{ path('app_test') }}" class="btn btn-secondary ms-2">
									Actualiser
								</a>
							</div>
						</div>

						{% if logs|length > 0 %}
							<hr>
							<h5>Logs r√©cents ({{ logs|length }})</h5>
							<div class="table-responsive">
								<table class="table table-striped">
									<thead>
										<tr>
											<th>ID</th>
											<th>Message</th>
											<th>Type</th>
											<th>Date</th>
										</tr>
									</thead>
									<tbody>
										{% for log in logs %}
											<tr>
												<td>{{ log.id }}</td>
												<td>{{ log.message }}</td>
												<td>
													<span class="badge bg-info">{{ log.type }}</span>
												</td>
												<td>{{ log.createdAt|date('d/m/Y H:i:s') }}</td>
											</tr>
										{% endfor %}
									</tbody>
								</table>
							</div>
						{% else %}
							<hr>
							<div class="alert alert-info">
								Aucun log trouv√©. Utilisez le bouton "Ajouter un log de test" pour cr√©er le premier log.
							</div>
						{% endif %}

						<div class="mt-3">
							<h5>Instructions de test</h5>
							<ol>
								<li>V√©rifiez que votre base de donn√©es MySQL est active (WAMP)</li>
								<li>Assurez-vous que la table
									<code>test_log</code>
									existe</li>
								<li>Cliquez sur "Ajouter un log de test" pour tester l'√©criture</li>
								<li>V√©rifiez que le log appara√Æt dans la liste</li>
							</ol>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
{% endblock %}

