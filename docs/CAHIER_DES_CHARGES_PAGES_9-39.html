<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Cahier des Charges - Projet MossAir (Pages 9-39)</title>
  <style>
    :root {
      --moss-green: #2d5a27;
      --moss-green-light: #4a7c59;
      --moss-green-dark: #1a3d17;
      --text-color: #333;
      --bg-light: #f8f9fa;
      --border-color: #dee2e6;
    }
    html {
      color: var(--text-color);
      background-color: var(--bg-light);
    }
    body {
      margin: 0 auto;
      max-width: 1000px;
      padding: 40px;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.7;
      background-color: white;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    h1 {
      color: var(--moss-green);
      border-bottom: 3px solid var(--moss-green);
      padding-bottom: 15px;
      font-size: 2.2em;
    }
    h2 {
      color: var(--moss-green);
      border-bottom: 2px solid var(--moss-green-light);
      padding-bottom: 10px;
      margin-top: 40px;
    }
    h3 {
      color: var(--moss-green-light);
      margin-top: 30px;
    }
    h4 {
      color: var(--moss-green-dark);
    }
    pre {
      background-color: #1e1e1e;
      color: #d4d4d4;
      padding: 15px;
      border-radius: 8px;
      overflow-x: auto;
      font-size: 0.9em;
      border-left: 4px solid var(--moss-green);
    }
    code {
      background-color: #f4f4f4;
      padding: 2px 6px;
      border-radius: 4px;
      font-family: 'Consolas', 'Monaco', monospace;
      color: #c7254e;
    }
    pre code {
      background: none;
      padding: 0;
      color: inherit;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }
    th, td {
      padding: 12px;
      text-align: left;
      border: 1px solid var(--border-color);
    }
    th {
      background-color: var(--moss-green);
      color: white;
    }
    tr:nth-child(even) {
      background-color: #f9f9f9;
    }
    blockquote {
      border-left: 4px solid var(--moss-green);
      margin: 20px 0;
      padding: 10px 20px;
      background-color: #f8f9fa;
      font-style: italic;
    }
    a {
      color: var(--moss-green);
    }
    a:hover {
      color: var(--moss-green-dark);
    }
    hr {
      border: none;
      border-top: 2px solid var(--border-color);
      margin: 30px 0;
    }
    #TOC {
      background-color: #f8f9fa;
      padding: 20px;
      border-radius: 8px;
      border: 1px solid var(--border-color);
      margin-bottom: 30px;
    }
    #TOC ul {
      list-style-type: none;
      padding-left: 20px;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a {
      text-decoration: none;
    }
    #TOC a:hover {
      text-decoration: underline;
    }
    .sourceCode {
      background-color: #1e1e1e !important;
    }
    @media (max-width: 768px) {
      body {
        padding: 20px;
        font-size: 0.95em;
      }
      h1 {
        font-size: 1.8em;
      }
      pre {
        font-size: 0.8em;
      }
    }
    @media print {
      body {
        box-shadow: none;
        max-width: 100%;
      }
      pre {
        white-space: pre-wrap;
        word-wrap: break-word;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
      pre, table {
        page-break-inside: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {  background-color: #f8f8f8; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ef2929; } /* Alert */
    code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #204a87; } /* Attribute */
    code span.bn { color: #0000cf; } /* BaseN */
    code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4e9a06; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #8f5902; font-style: italic; } /* Comment */
    code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
    code span.dt { color: #204a87; } /* DataType */
    code span.dv { color: #0000cf; } /* DecVal */
    code span.er { color: #a40000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #0000cf; } /* Float */
    code span.fu { color: #204a87; font-weight: bold; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
    code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
    code span.ot { color: #8f5902; } /* Other */
    code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
    code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
    code span.ss { color: #4e9a06; } /* SpecialString */
    code span.st { color: #4e9a06; } /* String */
    code span.va { color: #000000; } /* Variable */
    code span.vs { color: #4e9a06; } /* VerbatimString */
    code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Cahier des Charges - Projet MossAir (Pages 9-39)</h1>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#cahier-des-charges---projet-moss-pages-9-39"
id="toc-cahier-des-charges---projet-moss-pages-9-39">Cahier des Charges
- Projet Moss (Pages 9-39)</a>
<ul>
<li><a href="#partie-frontend-partie-backend"
id="toc-partie-frontend-partie-backend">Partie Frontend &amp;&amp;
Partie Backend</a></li>
<li><a href="#css-et-media-queries-design-responsive"
id="toc-css-et-media-queries-design-responsive">9. CSS et Media Queries
: Design Responsive</a>
<ul>
<li><a href="#exemple-header-responsive"
id="toc-exemple-header-responsive">Exemple : Header Responsive</a></li>
<li><a href="#tests-de-responsive" id="toc-tests-de-responsive">Tests de
Responsive</a></li>
<li><a href="#screenshots-interface-utilisateur-responsive"
id="toc-screenshots-interface-utilisateur-responsive">ğŸ“¸ Screenshots :
Interface Utilisateur Responsive</a></li>
</ul></li>
<li><a href="#javascript-et-interactivitÃ©"
id="toc-javascript-et-interactivitÃ©">10. JavaScript et InteractivitÃ©</a>
<ul>
<li><a href="#exemple-1-menu-hamburger-responsive"
id="toc-exemple-1-menu-hamburger-responsive">Exemple 1 : Menu Hamburger
Responsive</a></li>
<li><a href="#exemple-2-accÃ¨s-admin-secret"
id="toc-exemple-2-accÃ¨s-admin-secret">Exemple 2 : AccÃ¨s Admin
Secret</a></li>
<li><a href="#screenshots-formulaires-dauthentification-et-profil"
id="toc-screenshots-formulaires-dauthentification-et-profil">ğŸ“¸
Screenshots : Formulaires dâ€™Authentification et Profil</a></li>
<li><a href="#screenshots-pages-de-contenu"
id="toc-screenshots-pages-de-contenu">ğŸ“¸ Screenshots : Pages de
Contenu</a></li>
</ul></li>
<li><a href="#php-et-gestion-du-site-avec-symfony"
id="toc-php-et-gestion-du-site-avec-symfony">11. PHP et Gestion du Site
avec Symfony</a>
<ul>
<li><a href="#architecture-symfony"
id="toc-architecture-symfony">Architecture Symfony</a></li>
</ul></li>
<li><a href="#entity-produit-avec-gestion-du-stock"
id="toc-entity-produit-avec-gestion-du-stock">12. Entity Produit avec
Gestion du Stock</a>
<ul>
<li><a href="#code-de-lentity-produit"
id="toc-code-de-lentity-produit">Code de lâ€™Entity Produit</a></li>
</ul></li>
<li><a href="#migration-ajout-de-la-colonne-stock"
id="toc-migration-ajout-de-la-colonne-stock">13. Migration : Ajout de la
Colonne Stock</a>
<ul>
<li><a href="#code-de-la-migration" id="toc-code-de-la-migration">Code
de la Migration</a></li>
</ul></li>
<li><a href="#paniercontroller-gestion-complÃ¨te-du-panier"
id="toc-paniercontroller-gestion-complÃ¨te-du-panier">14.
PanierController : Gestion ComplÃ¨te du Panier</a>
<ul>
<li><a href="#structure-du-panier-en-session"
id="toc-structure-du-panier-en-session">Structure du Panier en
Session</a></li>
<li><a href="#mÃ©thode-afficher-le-panier"
id="toc-mÃ©thode-afficher-le-panier">MÃ©thode : Afficher le
Panier</a></li>
<li><a href="#mÃ©thode-ajouter-un-produit-au-panier"
id="toc-mÃ©thode-ajouter-un-produit-au-panier">MÃ©thode : Ajouter un
Produit au Panier</a></li>
<li><a href="#mÃ©thode-valider-le-paiement-et-dÃ©crÃ©menter-le-stock"
id="toc-mÃ©thode-valider-le-paiement-et-dÃ©crÃ©menter-le-stock">MÃ©thode :
Valider le Paiement et DÃ©crÃ©menter le Stock</a></li>
</ul></li>
<li><a href="#admincontroller-gestion-des-produits-et-du-stock"
id="toc-admincontroller-gestion-des-produits-et-du-stock">15.
AdminController : Gestion des Produits et du Stock</a>
<ul>
<li><a href="#mÃ©thode-de-vÃ©rification-admin"
id="toc-mÃ©thode-de-vÃ©rification-admin">MÃ©thode de VÃ©rification
Admin</a></li>
<li><a href="#mÃ©thode-crÃ©er-un-nouveau-produit"
id="toc-mÃ©thode-crÃ©er-un-nouveau-produit">MÃ©thode : CrÃ©er un Nouveau
Produit</a></li>
</ul></li>
<li><a href="#templates-twig-affichage-avec-gestion-du-stock"
id="toc-templates-twig-affichage-avec-gestion-du-stock">16. Templates
Twig : Affichage avec Gestion du Stock</a>
<ul>
<li><a href="#template-page-panier-panierindex.html.twig"
id="toc-template-page-panier-panierindex.html.twig">Template : Page
Panier (panier/index.html.twig)</a></li>
<li><a href="#template-dashboard-admin-admindashboard.html.twig"
id="toc-template-dashboard-admin-admindashboard.html.twig">Template :
Dashboard Admin (admin/dashboard.html.twig)</a></li>
<li><a href="#screenshots-pages-produits-panier-et-dashboard-admin"
id="toc-screenshots-pages-produits-panier-et-dashboard-admin">ğŸ“¸
Screenshots : Pages Produits, Panier et Dashboard Admin</a></li>
</ul></li>
<li><a href="#base-de-donnÃ©es-structure-et-relations"
id="toc-base-de-donnÃ©es-structure-et-relations">17. Base de DonnÃ©es :
Structure et Relations</a>
<ul>
<li><a href="#modÃ¨le-logique-de-donnÃ©es-mld"
id="toc-modÃ¨le-logique-de-donnÃ©es-mld">ModÃ¨le Logique de DonnÃ©es
(MLD)</a></li>
<li><a href="#screenshots-structure-rÃ©elle-des-tables-phpmyadmin"
id="toc-screenshots-structure-rÃ©elle-des-tables-phpmyadmin">ğŸ“¸
Screenshots : Structure RÃ©elle des Tables (phpMyAdmin)</a></li>
<li><a href="#screenshots-donnÃ©es-rÃ©elles-dans-les-tables-phpmyadmin"
id="toc-screenshots-donnÃ©es-rÃ©elles-dans-les-tables-phpmyadmin">ğŸ“¸
Screenshots : DonnÃ©es RÃ©elles dans les Tables (phpMyAdmin)</a></li>
<li><a href="#modÃ¨le-conceptuel-de-donnÃ©es-mcd"
id="toc-modÃ¨le-conceptuel-de-donnÃ©es-mcd">ModÃ¨le Conceptuel de DonnÃ©es
(MCD)</a></li>
</ul></li>
<li><a href="#flux-de-gestion-du-stock"
id="toc-flux-de-gestion-du-stock">18. Flux de Gestion du Stock</a>
<ul>
<li><a href="#diagramme-du-flux" id="toc-diagramme-du-flux">Diagramme du
Flux</a></li>
<li><a href="#exemple-concret" id="toc-exemple-concret">Exemple
Concret</a></li>
</ul></li>
<li><a href="#sÃ©curitÃ©-points-clÃ©s" id="toc-sÃ©curitÃ©-points-clÃ©s">19.
SÃ©curitÃ© : Points ClÃ©s</a>
<ul>
<li><a href="#hachage-des-mots-de-passe"
id="toc-hachage-des-mots-de-passe">1. Hachage des Mots de Passe</a></li>
<li><a href="#validation-des-entrÃ©es-utilisateur"
id="toc-validation-des-entrÃ©es-utilisateur">2. Validation des EntrÃ©es
Utilisateur</a></li>
<li><a href="#protection-csrf" id="toc-protection-csrf">3. Protection
CSRF</a></li>
<li><a href="#contrÃ´le-daccÃ¨s-admin" id="toc-contrÃ´le-daccÃ¨s-admin">4.
ContrÃ´le dâ€™AccÃ¨s Admin</a></li>
<li><a href="#prÃ©vention-des-stocks-nÃ©gatifs"
id="toc-prÃ©vention-des-stocks-nÃ©gatifs">5. PrÃ©vention des Stocks
NÃ©gatifs</a></li>
</ul></li>
<li><a href="#utilisation-de-symfony-avantages"
id="toc-utilisation-de-symfony-avantages">20. Utilisation de Symfony :
Avantages</a>
<ul>
<li><a href="#pourquoi-symfony" id="toc-pourquoi-symfony">Pourquoi
Symfony ?</a></li>
</ul></li>
<li><a href="#structure-du-projet-symfony"
id="toc-structure-du-projet-symfony">21. Structure du Projet Symfony</a>
<ul>
<li><a href="#arborescence-du-rÃ©pertoire-src"
id="toc-arborescence-du-rÃ©pertoire-src">Arborescence du RÃ©pertoire
<code>src/</code></a></li>
<li><a href="#fichiers-de-migrations-doctrine"
id="toc-fichiers-de-migrations-doctrine">Fichiers de Migrations
Doctrine</a></li>
<li><a href="#contenu-du-fichier-de-migration-stock"
id="toc-contenu-du-fichier-de-migration-stock">ğŸ“„ Contenu du Fichier de
Migration Stock</a></li>
</ul></li>
<li><a href="#conclusion-de-la-section-technique"
id="toc-conclusion-de-la-section-technique">Conclusion de la Section
Technique</a></li>
</ul></li>
</ul>
</nav>
<h1 id="cahier-des-charges---projet-moss-pages-9-39">Cahier des Charges
- Projet Moss (Pages 9-39)</h1>
<h2 id="partie-frontend-partie-backend">Partie Frontend &amp;&amp;
Partie Backend</h2>
<hr />
<h2 id="css-et-media-queries-design-responsive">9. CSS et Media Queries
: Design Responsive</h2>
<p>Pour garantir que le site soit <strong>responsive</strong> et
sâ€™adapte Ã  tous les types dâ€™appareils, jâ€™ai utilisÃ©
<strong>CSS3</strong> et les <strong>media queries</strong>. Les media
queries permettent dâ€™appliquer des styles spÃ©cifiques en fonction de la
taille de lâ€™Ã©cran.</p>
<h3 id="exemple-header-responsive">Exemple : Header Responsive</h3>
<p>Le header du site sâ€™adapte automatiquement selon la taille de
lâ€™Ã©cran. Sur mobile, un menu hamburger apparaÃ®t pour une navigation
optimale.</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode css"><code class="sourceCode css"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Header pour desktop */</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">.header-section</span> {</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">width</span>: <span class="dv">100</span><span class="dt">%</span><span class="op">;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">height</span>: <span class="bu">auto</span><span class="op">;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span>: <span class="dv">flex</span><span class="op">;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">flex-direction</span>: <span class="dv">column</span><span class="op">;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">justify-content</span>: <span class="dv">center</span><span class="op">;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">align-items</span>: <span class="dv">center</span><span class="op">;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">padding</span>: <span class="dv">15</span><span class="dt">px</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background</span>: <span class="fu">linear-gradient(</span><span class="dv">135</span><span class="dt">deg</span><span class="op">,</span> <span class="cn">#4a7c59</span><span class="op">,</span> <span class="cn">#6b8e7a</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">/* Media query pour tablettes (largeur max 990px) */</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">@media</span> (<span class="kw">max-width</span>: <span class="dv">990</span><span class="dt">px</span>) {</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">.header-section</span> {</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        <span class="kw">height</span>: <span class="dv">80</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">background</span>: <span class="cn">#4a7c59</span><span class="op">;</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">padding</span>: <span class="dv">10</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">align-items</span>: flex-start<span class="op">;</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">.list</span> ul {</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>        <span class="kw">flex-direction</span>: <span class="dv">column</span><span class="op">;</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>        <span class="kw">align-items</span>: flex-start<span class="op">;</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>        <span class="kw">justify-content</span>: flex-start<span class="op">;</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>        <span class="kw">height</span>: <span class="dv">100</span><span class="dt">vh</span><span class="op">;</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>        <span class="kw">width</span>: <span class="dv">250</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        <span class="kw">position</span>: <span class="dv">fixed</span><span class="op">;</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>        <span class="kw">top</span>: <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>        <span class="kw">right</span>: <span class="dv">-250</span><span class="dt">px</span><span class="op">;</span> <span class="co">/* CachÃ© par dÃ©faut */</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>        <span class="kw">background-color</span>: <span class="cn">#333</span><span class="op">;</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>        <span class="kw">transition</span>: <span class="dv">all</span> <span class="dv">0.4</span><span class="dt">s</span> <span class="dv">linear</span><span class="op">;</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>        <span class="kw">padding-top</span>: <span class="dv">20</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>        <span class="kw">padding-left</span>: <span class="dv">5</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>        <span class="kw">z-index</span>: <span class="dv">999</span><span class="op">;</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    <span class="co">/* Quand le menu est actif (ouvert) */</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">.list</span> ul<span class="fu">.active</span> {</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>        <span class="kw">right</span>: <span class="dv">0</span><span class="op">;</span> <span class="co">/* Menu visible */</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Explication</strong> : - Sur desktop, le header affiche tous
les liens de navigation horizontalement - Sur tablette/mobile
(max-width: 990px), le menu devient un panneau latÃ©ral qui glisse depuis
la droite - La propriÃ©tÃ© <code>transition</code> rend lâ€™animation
fluide</p>
<h3 id="tests-de-responsive">Tests de Responsive</h3>
<p>Jâ€™ai testÃ© le site sur plusieurs tailles dâ€™Ã©cran en utilisant les
outils de dÃ©veloppement du navigateur (F12 &gt; Mode responsive) pour
mâ€™assurer quâ€™il fonctionne bien sur : - <strong>Desktop</strong> :
1920x1080px - <strong>Tablette</strong> : 768x1024px -
<strong>Mobile</strong> : 375x667px</p>
<hr />
<h3 id="screenshots-interface-utilisateur-responsive">ğŸ“¸ Screenshots :
Interface Utilisateur Responsive</h3>
<h4 id="screenshot-7-page-daccueil---version-desktop">Screenshot 7 :
Page dâ€™Accueil - Version Desktop</h4>
<p><strong>Vue Desktop</strong> - Interface complÃ¨te sur grand Ã©cran
:</p>
<p><strong>Header de navigation</strong> : - Logo
<strong>â€œMossAirâ€</strong> Ã  gauche - Menu horizontal :
<code>Accueil | Produit | Histoire | Ã€ propos</code> - Bouton vert
<strong>â€œPanierâ€</strong> (accÃ¨s au panier) - Bouton rouge
<strong>â€œDashboardâ€</strong> (visible uniquement pour les admins) -
Badge utilisateur <strong>â€œarnaudâ€</strong> avec icÃ´ne (utilisateur
connectÃ©) - Lien <strong>â€œDÃ©connexionâ€</strong> en rouge</p>
<p><strong>Hero Section (Section principale)</strong> : - Grande image
de fond montrant le purificateur dâ€™air avec mousse vÃ©gÃ©tale - Titre
principal : <strong>â€œMossAirâ€</strong> - Sous-titre : <em>â€œPurificateur
dâ€™air naturel rÃ©volutionnaire qui utilise la mousse vivante pour crÃ©er
un environnement plus sainâ€</em> - Design Ã©purÃ© et professionnel</p>
<p><strong>Navigation visible</strong> : Tous les Ã©lÃ©ments sont alignÃ©s
horizontalement dans le header</p>
<hr />
<h4 id="screenshot-8-page-daccueil---version-mobile">Screenshot 8 : Page
dâ€™Accueil - Version Mobile</h4>
<p><strong>Vue Mobile</strong> - Interface responsive adaptÃ©e aux petits
Ã©crans :</p>
<p><strong>Changements responsive</strong> : - Logo
<strong>â€œMossAirâ€</strong> reste visible - Menu hamburger (icÃ´ne â˜°)
remplace la navigation horizontale - Le hero image sâ€™adapte Ã  la largeur
de lâ€™Ã©cran - Bouton call-to-action : <strong>â€œDÃ©couvrir
MossAirâ€</strong> (centrÃ©) - Texte responsive : taille et espacement
adaptÃ©s</p>
<p><strong>Section â€œEnvironâ€</strong> visible en bas : - Titre de
section avec fond sombre - Contenu texte adaptÃ© Ã  la largeur mobile</p>
<p><strong>Layout</strong> : Les Ã©lÃ©ments passent dâ€™une disposition
horizontale Ã  verticale pour une meilleure lisibilitÃ© sur mobile</p>
<hr />
<h4 id="screenshot-9-menu-hamburger-mobile-ouvert">Screenshot 9 : Menu
Hamburger Mobile Ouvert</h4>
<p><strong>Menu de navigation mobile dÃ©ployÃ©</strong> :</p>
<p><strong>Structure du menu latÃ©ral</strong> : - Fond vert foncÃ©
(<code>background-color: #333</code>) - Panneau qui glisse depuis la
droite (<code>right: -250px</code> â†’ <code>right: 0</code>) - Animation
fluide (<code>transition: all 0.4s linear</code>)</p>
<p><strong>Liens de navigation (ordre vertical)</strong> : 1.
<strong>Accueil</strong> 2. <strong>Produit</strong> 3.
<strong>Histoire</strong> 4. <strong>Ã€ propos</strong> 5.
<strong>Panier</strong> (bouton vert) 6. <strong>Dashboard</strong>
(bouton rouge, visible car admin connectÃ©) 7. <strong>â€œbonjour
arnaudâ€</strong> (badge utilisateur cerclÃ©) 8.
<strong>DÃ©connexion</strong> (lien rouge)</p>
<p><strong>Comportement</strong> : - Clic sur hamburger â†’ Menu sâ€™ouvre -
Clic sur un lien â†’ Menu se ferme automatiquement - Overlay
semi-transparent derriÃ¨re le menu</p>
<p><strong>Code correspondant</strong> :</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Menu hamburger toggle</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>hamburger<span class="op">.</span><span class="at">classList</span><span class="op">.</span><span class="fu">toggle</span>(<span class="st">&#39;active&#39;</span>)<span class="op">;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>navMenu<span class="op">.</span><span class="at">classList</span><span class="op">.</span><span class="fu">toggle</span>(<span class="st">&#39;active&#39;</span>)<span class="op">;</span></span></code></pre></div>
<hr />
<h4 id="screenshot-10-header---utilisateur-normal-non-admin">Screenshot
10 : Header - Utilisateur Normal (non-admin)</h4>
<p><strong>Vue header pour un utilisateur standard</strong> :</p>
<p><strong>Ã‰lÃ©ments visibles</strong> : - Logo
<strong>â€œMossAirâ€</strong> - Navigation :
<code>Accueil | Produit | Histoire | Ã€ propos</code> - Bouton
<strong>â€œPanierâ€</strong> (vert) - Badge utilisateur :
<strong>â€œuserâ€</strong> (au lieu de â€œarnaudâ€) - Lien
<strong>â€œDÃ©connexionâ€</strong> (rouge)</p>
<p><strong>Ã‰lÃ©ment MANQUANT</strong> : - âŒ Bouton
<strong>â€œDashboardâ€</strong> â†’ Non visible car
<code>role !== 'admin'</code></p>
<p><strong>Logique de contrÃ´le dâ€™accÃ¨s</strong> :</p>
<pre class="twig"><code>{% if app.session.get(&#39;user&#39;) and app.session.get(&#39;user&#39;).role == &#39;admin&#39; %}
    &lt;a href=&quot;{{ path(&#39;app_admin_dashboard&#39;) }}&quot; class=&quot;btn-dashboard&quot;&gt;
        Dashboard
    &lt;/a&gt;
{% endif %}</code></pre>
<p><strong>DiffÃ©rence clÃ©</strong> : Un utilisateur normal ne peut pas
accÃ©der au dashboard admin, donc le bouton est masquÃ©.</p>
<hr />
<h4 id="screenshot-11-header---administrateur-connectÃ©">Screenshot 11 :
Header - Administrateur ConnectÃ©</h4>
<p><strong>Vue header pour un administrateur</strong> :</p>
<p><strong>Ã‰lÃ©ments visibles</strong> : - Logo
<strong>â€œMossAirâ€</strong> - Navigation complÃ¨te :
<code>Accueil | Produit | Histoire | Ã€ propos</code> - Bouton
<strong>â€œPanierâ€</strong> (vert) - Bouton <strong>â€œDashboardâ€</strong>
(rouge) âœ… <strong>VISIBLE</strong> - Badge utilisateur :
<strong>â€œarnaudâ€</strong> (admin) - Lien <strong>â€œDÃ©connexionâ€</strong>
(rouge)</p>
<p><strong>Ã‰lÃ©ment PRÃ‰SENT</strong> : - âœ… Bouton
<strong>â€œDashboardâ€</strong> en rouge â†’ Visible car
<code>role === 'admin'</code></p>
<p><strong>ContrÃ´le dans le code</strong> :</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Dans AdminController</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">private</span> <span class="kw">function</span> checkAdmin(<span class="cn">S</span>essionInterface <span class="va">$session</span>)<span class="ot">:</span> <span class="dt">bool</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="va">$user</span> <span class="op">=</span> <span class="va">$session</span>-&gt;get(<span class="st">&#39;user&#39;</span>)<span class="ot">;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">$user</span> <span class="op">&amp;&amp;</span> <span class="kw">isset</span>(<span class="va">$user</span>[<span class="st">&#39;role&#39;</span>]) <span class="op">&amp;&amp;</span> <span class="va">$user</span>[<span class="st">&#39;role&#39;</span>] <span class="op">===</span> <span class="st">&#39;admin&#39;</span><span class="ot">;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">// VÃ©rification avant chaque action admin</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="op">!</span><span class="va">$this</span>-&gt;checkAdmin(<span class="va">$session</span>)) {</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="va">$this</span>-&gt;addFlash(<span class="st">&#39;error&#39;</span><span class="ot">,</span> <span class="st">&#39;AccÃ¨s refusÃ©. RÃ©servÃ© aux administrateurs.&#39;</span>)<span class="ot">;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">$this</span>-&gt;redirectToRoute(<span class="st">&#39;app_home&#39;</span>)<span class="ot">;</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>SÃ©curitÃ©</strong> : - Le bouton nâ€™est affichÃ© que si
lâ€™utilisateur a le rÃ´le <code>admin</code> en session - MÃªme si un
utilisateur modifie le HTML pour afficher le bouton, lâ€™accÃ¨s Ã  la route
<code>/admin</code> est bloquÃ© cÃ´tÃ© serveur</p>
<hr />
<h2 id="javascript-et-interactivitÃ©">10. JavaScript et
InteractivitÃ©</h2>
<p>JavaScript est utilisÃ© pour ajouter des fonctionnalitÃ©s interactives
et amÃ©liorer lâ€™expÃ©rience utilisateur.</p>
<h3 id="exemple-1-menu-hamburger-responsive">Exemple 1 : Menu Hamburger
Responsive</h3>
<p>Le menu hamburger permet dâ€™ouvrir/fermer le menu de navigation sur
mobile.</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Menu hamburger pour mobile/tablette</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>(<span class="kw">function</span>() {</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">initBurger</span>() {</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> hamburger <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;hamburger&#39;</span>)<span class="op">;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> navMenu <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;navMenu&#39;</span>)<span class="op">;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="op">!</span>hamburger <span class="op">||</span> <span class="op">!</span>navMenu) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Toggle menu au clic sur le bouton hamburger</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        hamburger<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> <span class="kw">function</span>(e) {</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>            e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>            hamburger<span class="op">.</span><span class="at">classList</span><span class="op">.</span><span class="fu">toggle</span>(<span class="st">&#39;active&#39;</span>)<span class="op">;</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>            navMenu<span class="op">.</span><span class="at">classList</span><span class="op">.</span><span class="fu">toggle</span>(<span class="st">&#39;active&#39;</span>)<span class="op">;</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>            hamburger<span class="op">.</span><span class="fu">setAttribute</span>(<span class="st">&#39;aria-expanded&#39;</span><span class="op">,</span> navMenu<span class="op">.</span><span class="at">classList</span><span class="op">.</span><span class="fu">contains</span>(<span class="st">&#39;active&#39;</span>))<span class="op">;</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>        })<span class="op">;</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Fermer le menu au clic sur un lien</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        navMenu<span class="op">.</span><span class="fu">querySelectorAll</span>(<span class="st">&#39;a&#39;</span>)<span class="op">.</span><span class="fu">forEach</span>(link <span class="kw">=&gt;</span> {</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>            link<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>                hamburger<span class="op">.</span><span class="at">classList</span><span class="op">.</span><span class="fu">remove</span>(<span class="st">&#39;active&#39;</span>)<span class="op">;</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>                navMenu<span class="op">.</span><span class="at">classList</span><span class="op">.</span><span class="fu">remove</span>(<span class="st">&#39;active&#39;</span>)<span class="op">;</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>                hamburger<span class="op">.</span><span class="fu">setAttribute</span>(<span class="st">&#39;aria-expanded&#39;</span><span class="op">,</span> <span class="st">&#39;false&#39;</span>)<span class="op">;</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>            })<span class="op">;</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>        })<span class="op">;</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Initialiser au chargement du DOM</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">document</span><span class="op">.</span><span class="at">readyState</span> <span class="op">===</span> <span class="st">&#39;loading&#39;</span>) {</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>        <span class="bu">document</span><span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&#39;DOMContentLoaded&#39;</span><span class="op">,</span> initBurger)<span class="op">;</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">initBurger</span>()<span class="op">;</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>})()<span class="op">;</span></span></code></pre></div>
<p><strong>Explication</strong> : - <code>IIFE</code> (fonction
auto-exÃ©cutÃ©e) pour isoler le code - <code>toggle('active')</code>
ajoute/retire la classe CSS qui montre/cache le menu - Le menu se ferme
automatiquement aprÃ¨s avoir cliquÃ© sur un lien</p>
<h3 id="exemple-2-accÃ¨s-admin-secret">Exemple 2 : AccÃ¨s Admin
Secret</h3>
<p>Un systÃ¨me dâ€™accÃ¨s admin cachÃ© via 3 clics sur le logo ou Ctrl+A.</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">// AccÃ¨s admin (Ctrl+A ou 3 clics sur logo)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="bu">document</span><span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&#39;DOMContentLoaded&#39;</span><span class="op">,</span> <span class="kw">function</span>() {</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> clickCount <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> clickTimer <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Raccourci clavier Ctrl+A</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">document</span><span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&#39;keydown&#39;</span><span class="op">,</span> <span class="kw">function</span>(e) {</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (e<span class="op">.</span><span class="at">ctrlKey</span> <span class="op">&amp;&amp;</span> e<span class="op">.</span><span class="at">key</span> <span class="op">===</span> <span class="st">&#39;a&#39;</span>) {</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>            e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>            <span class="bu">window</span><span class="op">.</span><span class="at">location</span><span class="op">.</span><span class="at">href</span> <span class="op">=</span> <span class="st">&#39;/admin&#39;</span><span class="op">;</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 3 clics sur le logo</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> siteLogo <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;siteLogo&#39;</span>)<span class="op">;</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (siteLogo) {</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>        siteLogo<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> <span class="kw">function</span>(e) {</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>            e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>            e<span class="op">.</span><span class="fu">stopPropagation</span>()<span class="op">;</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>            clickCount<span class="op">++;</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (clickTimer) <span class="pp">clearTimeout</span>(clickTimer)<span class="op">;</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Si 3 clics, ouvrir modale admin</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (clickCount <span class="op">&gt;=</span> <span class="dv">3</span>) {</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>                <span class="kw">const</span> modal <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;adminModal&#39;</span>)<span class="op">;</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (modal <span class="op">&amp;&amp;</span> <span class="kw">typeof</span> bootstrap <span class="op">!==</span> <span class="st">&#39;undefined&#39;</span>) {</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">new</span> bootstrap<span class="op">.</span><span class="fu">Modal</span>(modal)<span class="op">.</span><span class="fu">show</span>()<span class="op">;</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>                clickCount <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span><span class="op">;</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Timer: navigation normale aprÃ¨s 600ms si pas 3 clics</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>            clickTimer <span class="op">=</span> <span class="pp">setTimeout</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>                <span class="bu">window</span><span class="op">.</span><span class="at">location</span><span class="op">.</span><span class="at">href</span> <span class="op">=</span> siteLogo<span class="op">.</span><span class="at">href</span><span class="op">;</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>                clickCount <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span> <span class="dv">600</span>)<span class="op">;</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>        })<span class="op">;</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<p><strong>Explication</strong> : - Compte le nombre de clics sur le
logo dans un dÃ©lai de 600ms - Si 3 clics rapides â†’ ouvre la modale
dâ€™authentification admin - Sinon â†’ navigation normale vers lâ€™accueil</p>
<hr />
<h3 id="screenshots-formulaires-dauthentification-et-profil">ğŸ“¸
Screenshots : Formulaires dâ€™Authentification et Profil</h3>
<h4 id="screenshot-21-formulaire-de-connexion">Screenshot 21 :
Formulaire de Connexion</h4>
<p><strong>Page de connexion</strong> (<code>/connexion</code>) :</p>
<p><strong>Header</strong> : - Lien <strong>â€œConnexionâ€</strong> visible
pour les utilisateurs non connectÃ©s</p>
<p><strong>Formulaire avec onglets</strong> : - <strong>Onglet
â€œConnexionâ€</strong> (actif - bordure verte) - <strong>Onglet
â€œInscriptionâ€</strong> (inactif - lien cliquable)</p>
<p><strong>Champs du formulaire</strong> : 1. <strong>ğŸ‘¤ PrÃ©nom</strong>
(input texte) 2. <strong>ğŸ”’ Mot de passe</strong> (input password) 3.
<strong>â˜‘ï¸ Se souvenir de moi</strong> (checkbox) 4. <strong>Bouton vert
â€œğŸ”“ Se connecterâ€</strong> (pleine largeur)</p>
<p><strong>Code Twig correspondant</strong> :</p>
<pre class="twig"><code>{# templates/auth/login.html.twig #}
&lt;div class=&quot;auth-tabs&quot;&gt;
    &lt;button class=&quot;tab active&quot;&gt;Connexion&lt;/button&gt;
    &lt;a href=&quot;{{ path(&#39;app_register&#39;) }}&quot; class=&quot;tab&quot;&gt;Inscription&lt;/a&gt;
&lt;/div&gt;

&lt;form method=&quot;POST&quot; action=&quot;{{ path(&#39;app_login&#39;) }}&quot;&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;label&gt;ğŸ‘¤ PrÃ©nom&lt;/label&gt;
        &lt;input type=&quot;text&quot; name=&quot;prenom&quot; required&gt;
    &lt;/div&gt;

    &lt;div class=&quot;form-group&quot;&gt;
        &lt;label&gt;ğŸ”’ Mot de passe&lt;/label&gt;
        &lt;input type=&quot;password&quot; name=&quot;password&quot; required&gt;
    &lt;/div&gt;

    &lt;div class=&quot;form-check&quot;&gt;
        &lt;input type=&quot;checkbox&quot; name=&quot;remember_me&quot; id=&quot;remember&quot;&gt;
        &lt;label for=&quot;remember&quot;&gt;Se souvenir de moi&lt;/label&gt;
    &lt;/div&gt;

    &lt;button type=&quot;submit&quot; class=&quot;btn-submit&quot;&gt;ğŸ”“ Se connecter&lt;/button&gt;
&lt;/form&gt;</code></pre>
<p><strong>Controller PHP</strong> :</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span><span class="cn">R</span>oute(<span class="st">&#39;/connexion&#39;</span><span class="ot">,</span> name<span class="ot">:</span> <span class="st">&#39;app_login&#39;</span><span class="ot">,</span> methods<span class="ot">:</span> [<span class="st">&#39;GET&#39;</span><span class="ot">,</span> <span class="st">&#39;POST&#39;</span>])<span class="at">]</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">function</span> login(<span class="cn">R</span>equest <span class="va">$request</span><span class="ot">,</span> <span class="cn">S</span>essionInterface <span class="va">$session</span><span class="ot">,</span> <span class="cn">U</span>serRepository <span class="va">$userRepo</span>)<span class="ot">:</span> <span class="cn">R</span>esponse</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="va">$request</span>-&gt;isMethod(<span class="st">&#39;POST&#39;</span>)) {</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">$prenom</span> <span class="op">=</span> <span class="va">$request</span>-&gt;request-&gt;get(<span class="st">&#39;prenom&#39;</span>)<span class="ot">;</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">$password</span> <span class="op">=</span> <span class="va">$request</span>-&gt;request-&gt;get(<span class="st">&#39;password&#39;</span>)<span class="ot">;</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Chercher l&#39;utilisateur par prÃ©nom</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">$user</span> <span class="op">=</span> <span class="va">$userRepo</span>-&gt;findOneBy([<span class="st">&#39;prenom&#39;</span> =&gt; <span class="va">$prenom</span>])<span class="ot">;</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">// VÃ©rifier le mot de passe</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="va">$user</span> <span class="op">&amp;&amp;</span> <span class="fu">password_verify</span>(<span class="va">$password</span><span class="ot">,</span> <span class="va">$user</span>-&gt;getPassword())) {</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Stocker l&#39;utilisateur en session</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>            <span class="va">$session</span>-&gt;set(<span class="st">&#39;user&#39;</span><span class="ot">,</span> [</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;id&#39;</span> =&gt; <span class="va">$user</span>-&gt;getId()<span class="ot">,</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;prenom&#39;</span> =&gt; <span class="va">$user</span>-&gt;getPrenom()<span class="ot">,</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;nom&#39;</span> =&gt; <span class="va">$user</span>-&gt;getNom()<span class="ot">,</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;email&#39;</span> =&gt; <span class="va">$user</span>-&gt;getEmail()<span class="ot">,</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;role&#39;</span> =&gt; <span class="va">$user</span>-&gt;getRole()</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>            ])<span class="ot">;</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>            <span class="va">$this</span>-&gt;addFlash(<span class="st">&#39;success&#39;</span><span class="ot">,</span> <span class="st">&#39;Connexion rÃ©ussie !&#39;</span>)<span class="ot">;</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">$this</span>-&gt;redirectToRoute(<span class="st">&#39;app_home&#39;</span>)<span class="ot">;</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>        <span class="va">$this</span>-&gt;addFlash(<span class="st">&#39;error&#39;</span><span class="ot">,</span> <span class="st">&#39;Identifiants incorrects&#39;</span>)<span class="ot">;</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">$this</span>-&gt;render(<span class="st">&#39;auth/login.html.twig&#39;</span>)<span class="ot">;</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<hr />
<h4 id="screenshot-22-formulaire-dinscription">Screenshot 22 :
Formulaire dâ€™Inscription</h4>
<p><strong>Page dâ€™inscription</strong> (<code>/inscription</code>) :</p>
<p><strong>Formulaire avec onglets</strong> : - <strong>Onglet
â€œConnexionâ€</strong> (inactif - lien cliquable) - <strong>Onglet
â€œInscriptionâ€</strong> (actif - bordure verte)</p>
<p><strong>Champs du formulaire</strong> : 1. <strong>ğŸ‘¤ PrÃ©nom</strong>
(input texte) 2. <strong>ğŸ‘¤ Nom</strong> (input texte) 3. <strong>ğŸ“§
Email</strong> (input email) 4. <strong>ğŸ”’ Mot de passe</strong> (input
password) - Indication : <em>â€œMinimum 6 caractÃ¨resâ€</em> 5. <strong>ğŸ”’
Confirmer le mot de passe</strong> (input password) 6. <strong>â˜‘ï¸
Jâ€™accepte les conditions dâ€™utilisation</strong> (checkbox avec lien
bleu) 7. <strong>Bouton vert â€œğŸ‘¥ Sâ€™inscrireâ€</strong> (pleine
largeur)</p>
<p><strong>Code Twig</strong> :</p>
<pre class="twig"><code>{# templates/auth/register.html.twig #}
&lt;form method=&quot;POST&quot; action=&quot;{{ path(&#39;app_register&#39;) }}&quot;&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;label&gt;ğŸ‘¤ PrÃ©nom&lt;/label&gt;
        &lt;input type=&quot;text&quot; name=&quot;prenom&quot; required&gt;
    &lt;/div&gt;

    &lt;div class=&quot;form-group&quot;&gt;
        &lt;label&gt;ğŸ‘¤ Nom&lt;/label&gt;
        &lt;input type=&quot;text&quot; name=&quot;nom&quot; required&gt;
    &lt;/div&gt;

    &lt;div class=&quot;form-group&quot;&gt;
        &lt;label&gt;ğŸ“§ Email&lt;/label&gt;
        &lt;input type=&quot;email&quot; name=&quot;email&quot; required&gt;
    &lt;/div&gt;

    &lt;div class=&quot;form-group&quot;&gt;
        &lt;label&gt;ğŸ”’ Mot de passe&lt;/label&gt;
        &lt;input type=&quot;password&quot; name=&quot;password&quot; required minlength=&quot;6&quot;&gt;
        &lt;small&gt;Minimum 6 caractÃ¨res&lt;/small&gt;
    &lt;/div&gt;

    &lt;div class=&quot;form-group&quot;&gt;
        &lt;label&gt;ğŸ”’ Confirmer le mot de passe&lt;/label&gt;
        &lt;input type=&quot;password&quot; name=&quot;password_confirm&quot; required&gt;
    &lt;/div&gt;

    &lt;div class=&quot;form-check&quot;&gt;
        &lt;input type=&quot;checkbox&quot; name=&quot;accept_terms&quot; required&gt;
        &lt;label&gt;J&#39;accepte les &lt;a href=&quot;#&quot;&gt;conditions d&#39;utilisation&lt;/a&gt;&lt;/label&gt;
    &lt;/div&gt;

    &lt;button type=&quot;submit&quot; class=&quot;btn-submit&quot;&gt;ğŸ‘¥ S&#39;inscrire&lt;/button&gt;
&lt;/form&gt;</code></pre>
<p><strong>Controller PHP</strong> :</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span><span class="cn">R</span>oute(<span class="st">&#39;/inscription&#39;</span><span class="ot">,</span> name<span class="ot">:</span> <span class="st">&#39;app_register&#39;</span><span class="ot">,</span> methods<span class="ot">:</span> [<span class="st">&#39;GET&#39;</span><span class="ot">,</span> <span class="st">&#39;POST&#39;</span>])<span class="at">]</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">function</span> register(<span class="cn">R</span>equest <span class="va">$request</span><span class="ot">,</span> <span class="cn">E</span>ntityManagerInterface <span class="va">$em</span>)<span class="ot">:</span> <span class="cn">R</span>esponse</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="va">$request</span>-&gt;isMethod(<span class="st">&#39;POST&#39;</span>)) {</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">$password</span> <span class="op">=</span> <span class="va">$request</span>-&gt;request-&gt;get(<span class="st">&#39;password&#39;</span>)<span class="ot">;</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">$passwordConfirm</span> <span class="op">=</span> <span class="va">$request</span>-&gt;request-&gt;get(<span class="st">&#39;password_confirm&#39;</span>)<span class="ot">;</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">// VÃ©rifier que les mots de passe correspondent</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="va">$password</span> <span class="op">!==</span> <span class="va">$passwordConfirm</span>) {</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>            <span class="va">$this</span>-&gt;addFlash(<span class="st">&#39;error&#39;</span><span class="ot">,</span> <span class="st">&#39;Les mots de passe ne correspondent pas&#39;</span>)<span class="ot">;</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">$this</span>-&gt;redirectToRoute(<span class="st">&#39;app_register&#39;</span>)<span class="ot">;</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>        <span class="co">// CrÃ©er l&#39;utilisateur</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">$user</span> <span class="op">=</span> <span class="kw">new</span> <span class="cn">U</span>ser()<span class="ot">;</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">$user</span>-&gt;setPrenom(<span class="va">$request</span>-&gt;request-&gt;get(<span class="st">&#39;prenom&#39;</span>))<span class="ot">;</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">$user</span>-&gt;setNom(<span class="va">$request</span>-&gt;request-&gt;get(<span class="st">&#39;nom&#39;</span>))<span class="ot">;</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">$user</span>-&gt;setEmail(<span class="va">$request</span>-&gt;request-&gt;get(<span class="st">&#39;email&#39;</span>))<span class="ot">;</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>        <span class="va">$user</span>-&gt;setPassword(<span class="fu">password_hash</span>(<span class="va">$password</span><span class="ot">,</span> <span class="cn">PASSWORD_DEFAULT</span>))<span class="ot">;</span> <span class="co">// Hachage bcrypt</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">$user</span>-&gt;setRole(<span class="st">&#39;user&#39;</span>)<span class="ot">;</span> <span class="co">// RÃ´le par dÃ©faut</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">$user</span>-&gt;setCreatedAt(<span class="kw">new</span> \<span class="bu">DateTimeImmutable</span>())<span class="ot">;</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">$user</span>-&gt;setUpdatedAt(<span class="kw">new</span> \<span class="bu">DateTimeImmutable</span>())<span class="ot">;</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>        <span class="va">$em</span>-&gt;persist(<span class="va">$user</span>)<span class="ot">;</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>        <span class="va">$em</span>-&gt;<span class="fu">flush</span>()<span class="ot">;</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>        <span class="va">$this</span>-&gt;addFlash(<span class="st">&#39;success&#39;</span><span class="ot">,</span> <span class="st">&#39;Inscription rÃ©ussie ! Vous pouvez vous connecter.&#39;</span>)<span class="ot">;</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">$this</span>-&gt;redirectToRoute(<span class="st">&#39;app_login&#39;</span>)<span class="ot">;</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">$this</span>-&gt;render(<span class="st">&#39;auth/register.html.twig&#39;</span>)<span class="ot">;</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Validation</strong> : - Mot de passe minimum 6 caractÃ¨res
(HTML5 <code>minlength="6"</code>) - Email valide (HTML5
<code>type="email"</code>) - Acceptation des CGU obligatoire
(<code>required</code>) - VÃ©rification de correspondance des mots de
passe cÃ´tÃ© serveur</p>
<hr />
<h4
id="screenshot-23-modal-modification-du-profil-utilisateur">Screenshot
23 : Modal Modification du Profil Utilisateur</h4>
<p><strong>Popup de modification du profil</strong> :</p>
<p><strong>Header du modal</strong> : - Titre : <strong>â€œğŸ‘¤ Modifier le
profilâ€</strong> - Bouton fermer <strong>Ã—</strong> (en haut Ã 
droite)</p>
<p><strong>Formulaire de modification</strong> :</p>
<p><strong>Section photo</strong> : - Photo de profil actuelle (cercle)
- Texte : <strong>â€œChanger la photoâ€</strong> - Bouton <strong>â€œChoisir
un fichierâ€</strong> | <strong>â€œAuâ€¦oisiâ€</strong> - Info : <em>â€œFormats
acceptÃ©s : JPG, PNG (max 5MB)â€</em></p>
<p><strong>Champs du formulaire</strong> : 1. <strong>ğŸ‘¤ Nom
complet</strong> : <code>user</code> (prÃ©-rempli) 2. <strong>ğŸ“§
Email</strong> : <code>user@gmail.com</code> (prÃ©-rempli) 3. <strong>ğŸ“
TÃ©lÃ©phone</strong> : <code>Non dÃ©fini</code> (optionnel) 4. <strong>ğŸ“
Adresse</strong> : <code>Non dÃ©finie</code> (textarea)</p>
<p><strong>Boutons dâ€™action</strong> : - Bouton gris <strong>â€œÃ—
Annulerâ€</strong> (ferme le modal) - Bouton vert <strong>â€œğŸ’¾
Sauvegarderâ€</strong> (enregistre les modifications)</p>
<p><strong>Code JavaScript (ouverture du modal)</strong> :</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;btnModifierProfil&#39;</span>)<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> <span class="kw">function</span>() {</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Charger les donnÃ©es utilisateur depuis la session</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> user <span class="op">=</span> {{ app<span class="op">.</span><span class="at">session</span><span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;user&#39;</span>)<span class="op">|</span>json_encode<span class="op">|</span>raw }}<span class="op">;</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// PrÃ©-remplir les champs</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;inputNomComplet&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> user<span class="op">.</span><span class="at">prenom</span> <span class="op">+</span> <span class="st">&#39; &#39;</span> <span class="op">+</span> user<span class="op">.</span><span class="at">nom</span><span class="op">;</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;inputEmail&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> user<span class="op">.</span><span class="at">email</span><span class="op">;</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;inputTelephone&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> user<span class="op">.</span><span class="at">telephone</span> <span class="op">||</span> <span class="st">&#39;Non dÃ©fini&#39;</span><span class="op">;</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;inputAdresse&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> user<span class="op">.</span><span class="at">adresse</span> <span class="op">||</span> <span class="st">&#39;Non dÃ©finie&#39;</span><span class="op">;</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Afficher le modal Bootstrap</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> profileModal <span class="op">=</span> <span class="kw">new</span> bootstrap<span class="op">.</span><span class="fu">Modal</span>(<span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;profileModal&#39;</span>))<span class="op">;</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    profileModal<span class="op">.</span><span class="fu">show</span>()<span class="op">;</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<p><strong>Controller PHP (mise Ã  jour)</strong> :</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span><span class="cn">R</span>oute(<span class="st">&#39;/profil/update&#39;</span><span class="ot">,</span> name<span class="ot">:</span> <span class="st">&#39;app_profile_update&#39;</span><span class="ot">,</span> methods<span class="ot">:</span> [<span class="st">&#39;POST&#39;</span>])<span class="at">]</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">function</span> updateProfile(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="cn">R</span>equest <span class="va">$request</span><span class="ot">,</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="cn">S</span>essionInterface <span class="va">$session</span><span class="ot">,</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">U</span>serRepository <span class="va">$userRepo</span><span class="ot">,</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">E</span>ntityManagerInterface <span class="va">$em</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>)<span class="ot">:</span> <span class="cn">R</span>esponse {</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="va">$user</span> <span class="op">=</span> <span class="va">$session</span>-&gt;get(<span class="st">&#39;user&#39;</span>)<span class="ot">;</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="va">$userEntity</span> <span class="op">=</span> <span class="va">$userRepo</span>-&gt;find(<span class="va">$user</span>[<span class="st">&#39;id&#39;</span>])<span class="ot">;</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// GÃ©rer l&#39;upload de photo</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="va">$photoFile</span> <span class="op">=</span> <span class="va">$request</span>-&gt;files-&gt;get(<span class="st">&#39;photo&#39;</span>)<span class="ot">;</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="va">$photoFile</span>) {</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">$newFilename</span> <span class="op">=</span> <span class="fu">uniqid</span>() <span class="op">.</span> <span class="st">&#39;.&#39;</span> <span class="op">.</span> <span class="va">$photoFile</span>-&gt;guessExtension()<span class="ot">;</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">$photoFile</span>-&gt;move(<span class="va">$this</span>-&gt;getParameter(<span class="st">&#39;photos_directory&#39;</span>)<span class="ot">,</span> <span class="va">$newFilename</span>)<span class="ot">;</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">$userEntity</span>-&gt;setPhoto(<span class="va">$newFilename</span>)<span class="ot">;</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Mettre Ã  jour les champs</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    <span class="va">$userEntity</span>-&gt;setTelephone(<span class="va">$request</span>-&gt;request-&gt;get(<span class="st">&#39;telephone&#39;</span>))<span class="ot">;</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="va">$userEntity</span>-&gt;setAdresse(<span class="va">$request</span>-&gt;request-&gt;get(<span class="st">&#39;adresse&#39;</span>))<span class="ot">;</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    <span class="va">$userEntity</span>-&gt;setUpdatedAt(<span class="kw">new</span> \<span class="bu">DateTimeImmutable</span>())<span class="ot">;</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    <span class="va">$em</span>-&gt;<span class="fu">flush</span>()<span class="ot">;</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    <span class="va">$this</span>-&gt;addFlash(<span class="st">&#39;success&#39;</span><span class="ot">,</span> <span class="st">&#39;Profil mis Ã  jour avec succÃ¨s&#39;</span>)<span class="ot">;</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">$this</span>-&gt;redirectToRoute(<span class="st">&#39;app_profile&#39;</span>)<span class="ot">;</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<hr />
<h3 id="screenshots-pages-de-contenu">ğŸ“¸ Screenshots : Pages de
Contenu</h3>
<h4 id="screenshot-24-page-histoire">Screenshot 24 : Page
â€œHistoireâ€</h4>
<p><strong>Route</strong> : <code>/histoire</code></p>
<p><strong>Header</strong> : - Navigation complÃ¨te - Badge utilisateur
<strong>â€œuserâ€</strong> connectÃ©</p>
<p><strong>Hero Section</strong> : - <strong>Grande image de
fond</strong> : Mousse verte en gros plan avec effet bokeh -
<strong>Overlay</strong> : DÃ©gradÃ© pour amÃ©liorer la lisibilitÃ© -
<strong>Texte principal (centrÃ©)</strong> : - <em>â€œLibÃ©rez la puissance
de la nature avec la mousse.â€</em> - <em>â€œPurifiez votre air, augmentez
lâ€™humiditÃ©, crÃ©ez un environnement paisible.â€</em> - <em>â€œSublimez votre
espace avec la beautÃ© et les bienfaits de la mousse.â€</em></p>
<p><strong>Design</strong> : - Typographie en blanc avec ombre portÃ©e -
Image immersive (plein Ã©cran) - Ambiance naturelle et zen</p>
<p><strong>Code Twig</strong> :</p>
<pre class="twig"><code>{# templates/page/histoire.html.twig #}
{% extends &#39;base.html.twig&#39; %}

{% block body %}
    &lt;section class=&quot;hero-histoire&quot; style=&quot;background-image: url(&#39;{{ asset(&#39;images/moss-nature.jpg&#39;) }}&#39;);&quot;&gt;
        &lt;div class=&quot;hero-overlay&quot;&gt;&lt;/div&gt;
        &lt;div class=&quot;hero-content&quot;&gt;
            &lt;h1&gt;LibÃ©rez la puissance de la nature avec la mousse.&lt;/h1&gt;
            &lt;p&gt;Purifiez votre air, augmentez l&#39;humiditÃ©, crÃ©ez un environnement paisible.&lt;/p&gt;
            &lt;p&gt;Sublimez votre espace avec la beautÃ© et les bienfaits de la mousse.&lt;/p&gt;
        &lt;/div&gt;
    &lt;/section&gt;
{% endblock %}</code></pre>
<p><strong>CSS pour lâ€™effet parallaxe</strong> :</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode css"><code class="sourceCode css"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">.hero-histoire</span> {</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">position</span>: <span class="dv">relative</span><span class="op">;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">height</span>: <span class="dv">80</span><span class="dt">vh</span><span class="op">;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background-size</span>: <span class="dv">cover</span><span class="op">;</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background-position</span>: <span class="dv">center</span><span class="op">;</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background-attachment</span>: <span class="dv">fixed</span><span class="op">;</span> <span class="co">/* Effet parallaxe */</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span>: <span class="dv">flex</span><span class="op">;</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">align-items</span>: <span class="dv">center</span><span class="op">;</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">justify-content</span>: <span class="dv">center</span><span class="op">;</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="fu">.hero-overlay</span> {</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">position</span>: <span class="dv">absolute</span><span class="op">;</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">top</span>: <span class="dv">0</span><span class="op">;</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">left</span>: <span class="dv">0</span><span class="op">;</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">width</span>: <span class="dv">100</span><span class="dt">%</span><span class="op">;</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">height</span>: <span class="dv">100</span><span class="dt">%</span><span class="op">;</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background</span>: <span class="fu">rgba(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0.4</span><span class="fu">)</span><span class="op">;</span> <span class="co">/* Overlay sombre */</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="fu">.hero-content</span> {</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">position</span>: <span class="dv">relative</span><span class="op">;</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">z-index</span>: <span class="dv">10</span><span class="op">;</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span>: <span class="cn">white</span><span class="op">;</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">text-align</span>: <span class="dv">center</span><span class="op">;</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">padding</span>: <span class="dv">2</span><span class="dt">rem</span><span class="op">;</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">text-shadow</span>: <span class="dv">2</span><span class="dt">px</span> <span class="dv">2</span><span class="dt">px</span> <span class="dv">8</span><span class="dt">px</span> <span class="fu">rgba(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0.7</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="fu">.hero-content</span> h1 {</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">font-size</span>: <span class="dv">3</span><span class="dt">rem</span><span class="op">;</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">margin-bottom</span>: <span class="dv">1.5</span><span class="dt">rem</span><span class="op">;</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a><span class="fu">.hero-content</span> p {</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">font-size</span>: <span class="dv">1.5</span><span class="dt">rem</span><span class="op">;</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    <span class="kw">line-height</span>: <span class="dv">1.8</span><span class="op">;</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<hr />
<h4 id="screenshot-25-page-Ã -propos-footer">Screenshot 25 : Page â€œÃ€
proposâ€ + Footer</h4>
<p><strong>Route</strong> : <code>/a-propos</code></p>
<p><strong>Contenu principal</strong> : - Titre : <strong>â€œÃ€ propos de
MossAirâ€</strong> - <strong>3 paragraphes</strong> : 1. PrÃ©sentation
dâ€™Arnaud Barotteaux (crÃ©ateur) 2. Philosophie du projet (respiration
consciente, neurochimie positive) 3. Description de MossAir
(purificateur dâ€™air avec mousse vivante)</p>
<p><strong>Footer du site</strong> (fond noir) :</p>
<p><strong>4 colonnes</strong> :</p>
<ol type="1">
<li><strong>Environ</strong> (vert) :
<ul>
<li>Texte : â€œMosslab considÃ¨re la beautÃ© et les avantages de la mousse
comme une alternative concise et durable Ã  la verdure
traditionnelleâ€¦â€</li>
</ul></li>
<li><strong>Boutique</strong> (vert) :
<ul>
<li>Moss Air</li>
<li>Double Air Mousse</li>
<li>Sac Ã  dos tout-en-un Moss Air</li>
<li>Filtre Ã  mousse</li>
</ul></li>
<li><strong>Ressources</strong> (vert) :
<ul>
<li>Histoire</li>
<li>(autres liens)</li>
</ul></li>
<li><strong>Support</strong> (vert) :
<ul>
<li>Politique de confidentialitÃ©</li>
<li>CGV</li>
<li>GÃ©rer mes cookies</li>
</ul></li>
</ol>
<p><strong>Code Twig du footer</strong> :</p>
<pre class="twig"><code>{# templates/includes/footer.html.twig #}
&lt;footer class=&quot;site-footer&quot;&gt;
    &lt;div class=&quot;footer-container&quot;&gt;
        &lt;div class=&quot;footer-col&quot;&gt;
            &lt;h3&gt;Environ&lt;/h3&gt;
            &lt;p&gt;Mosslab considÃ¨re la beautÃ© et les avantages de la mousse comme une
            alternative concise et durable Ã  la verdure traditionnelle. Notre mission
            est de reconnecter l&#39;humain Ã  la nature.&lt;/p&gt;
        &lt;/div&gt;

        &lt;div class=&quot;footer-col&quot;&gt;
            &lt;h3&gt;Boutique&lt;/h3&gt;
            &lt;ul&gt;
                &lt;li&gt;&lt;a href=&quot;{{ path(&#39;app_produit&#39;) }}&quot;&gt;Moss Air&lt;/a&gt;&lt;/li&gt;
                &lt;li&gt;&lt;a href=&quot;#&quot;&gt;Double Air Mousse&lt;/a&gt;&lt;/li&gt;
                &lt;li&gt;&lt;a href=&quot;#&quot;&gt;Sac Ã  dos tout-en-un Moss Air&lt;/a&gt;&lt;/li&gt;
                &lt;li&gt;&lt;a href=&quot;#&quot;&gt;Filtre Ã  mousse&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
        &lt;/div&gt;

        &lt;div class=&quot;footer-col&quot;&gt;
            &lt;h3&gt;Ressources&lt;/h3&gt;
            &lt;ul&gt;
                &lt;li&gt;&lt;a href=&quot;{{ path(&#39;app_histoire&#39;) }}&quot;&gt;Histoire&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
        &lt;/div&gt;

        &lt;div class=&quot;footer-col&quot;&gt;
            &lt;h3&gt;Support&lt;/h3&gt;
            &lt;ul&gt;
                &lt;li&gt;&lt;a href=&quot;#&quot;&gt;Politique de confidentialitÃ©&lt;/a&gt;&lt;/li&gt;
                &lt;li&gt;&lt;a href=&quot;#&quot;&gt;CGV&lt;/a&gt;&lt;/li&gt;
                &lt;li&gt;&lt;a href=&quot;#&quot;&gt;GÃ©rer mes cookies&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/footer&gt;</code></pre>
<p><strong>CSS du footer</strong> :</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode css"><code class="sourceCode css"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">.site-footer</span> {</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background-color</span>: <span class="cn">#1a1a1a</span><span class="op">;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span>: <span class="cn">#fff</span><span class="op">;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">padding</span>: <span class="dv">3</span><span class="dt">rem</span> <span class="dv">0</span> <span class="dv">1</span><span class="dt">rem</span><span class="op">;</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">.footer-container</span> {</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span>: <span class="dv">grid</span><span class="op">;</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">grid-template-columns</span>: <span class="fu">repeat(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">1</span><span class="dt">fr</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">gap</span>: <span class="dv">2</span><span class="dt">rem</span><span class="op">;</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">max-width</span>: <span class="dv">1200</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">margin</span>: <span class="dv">0</span> <span class="bu">auto</span><span class="op">;</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">padding</span>: <span class="dv">0</span> <span class="dv">2</span><span class="dt">rem</span><span class="op">;</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="fu">.footer-col</span> h3 {</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span>: <span class="cn">#6b8e7a</span><span class="op">;</span> <span class="co">/* Vert MossAir */</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">margin-bottom</span>: <span class="dv">1</span><span class="dt">rem</span><span class="op">;</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">font-size</span>: <span class="dv">1.2</span><span class="dt">rem</span><span class="op">;</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="fu">.footer-col</span> ul {</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">list-style</span>: <span class="dv">none</span><span class="op">;</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">padding</span>: <span class="dv">0</span><span class="op">;</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a><span class="fu">.footer-col</span> ul li {</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">margin-bottom</span>: <span class="dv">0.5</span><span class="dt">rem</span><span class="op">;</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="fu">.footer-col</span> a {</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span>: <span class="cn">#ccc</span><span class="op">;</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">text-decoration</span>: <span class="dv">none</span><span class="op">;</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">transition</span>: color <span class="dv">0.3</span><span class="dt">s</span><span class="op">;</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a><span class="fu">.footer-col</span> a<span class="in">:hover</span> {</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span>: <span class="cn">#6b8e7a</span><span class="op">;</span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a><span class="co">/* Responsive footer */</span></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a><span class="im">@media</span> (<span class="kw">max-width</span>: <span class="dv">768</span><span class="dt">px</span>) {</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">.footer-container</span> {</span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>        <span class="kw">grid-template-columns</span>: <span class="dv">1</span><span class="dt">fr</span><span class="op">;</span></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>        <span class="kw">text-align</span>: <span class="dv">center</span><span class="op">;</span></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<hr />
<h2 id="php-et-gestion-du-site-avec-symfony">11. PHP et Gestion du Site
avec Symfony</h2>
<p>Le projet utilise le framework <strong>Symfony</strong> pour gÃ©rer
les interactions cÃ´tÃ© serveur, traiter les donnÃ©es et garantir la
sÃ©curitÃ©.</p>
<h3 id="architecture-symfony">Architecture Symfony</h3>
<pre><code>src/
â”œâ”€â”€ Controller/
â”‚   â”œâ”€â”€ PanierController.php      # Gestion du panier
â”‚   â”œâ”€â”€ AdminController.php       # Dashboard admin
â”‚   â”œâ”€â”€ ProduitController.php     # Liste des produits
â”‚   â””â”€â”€ SecurityController.php    # Authentification
â”œâ”€â”€ Entity/
â”‚   â”œâ”€â”€ Produit.php               # EntitÃ© Produit (avec stock)
â”‚   â”œâ”€â”€ User.php                  # EntitÃ© Utilisateur
â”‚   â””â”€â”€ Commande.php              # EntitÃ© Commande
â”œâ”€â”€ Repository/
â”‚   â”œâ”€â”€ ProduitRepository.php
â”‚   â””â”€â”€ UserRepository.php
migrations/
â””â”€â”€ Version20251203150000.php     # Migration ajout stock</code></pre>
<hr />
<h2 id="entity-produit-avec-gestion-du-stock">12. Entity Produit avec
Gestion du Stock</h2>
<p>Lâ€™entitÃ© <code>Produit</code> reprÃ©sente un produit en base de
donnÃ©es avec Doctrine ORM.</p>
<h3 id="code-de-lentity-produit">Code de lâ€™Entity Produit</h3>
<div class="sourceCode" id="cb18"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;?php</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> <span class="cn">A</span>pp\<span class="cn">E</span>ntity<span class="ot">;</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="cn">A</span>pp\<span class="cn">R</span>epository\<span class="cn">P</span>roduitRepository<span class="ot">;</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="cn">D</span>octrine\<span class="cn">ORM</span>\<span class="cn">M</span>apping <span class="kw">as</span> <span class="cn">ORM</span><span class="ot">;</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span><span class="cn">ORM</span>\<span class="cn">E</span>ntity(repositoryClass<span class="ot">:</span> <span class="cn">P</span>roduitRepository::<span class="kw">class</span>)<span class="at">]</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> <span class="cn">P</span>roduit</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Identifiant unique auto-incrÃ©mentÃ©</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">#[</span><span class="cn">ORM</span>\<span class="cn">I</span>d<span class="at">]</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">#[</span><span class="cn">ORM</span>\<span class="cn">G</span>eneratedValue<span class="at">]</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">#[</span><span class="cn">ORM</span>\<span class="cn">C</span>olumn<span class="at">]</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="ot">?</span><span class="dt">int</span> <span class="va">$id</span> <span class="op">=</span> <span class="kw">null</span><span class="ot">;</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Nom du produit (obligatoire, max 255 caractÃ¨res)</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">#[</span><span class="cn">ORM</span>\<span class="cn">C</span>olumn(length<span class="ot">:</span> <span class="dv">255</span>)<span class="at">]</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="ot">?</span><span class="dt">string</span> <span class="va">$nom</span> <span class="op">=</span> <span class="kw">null</span><span class="ot">;</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Description dÃ©taillÃ©e (texte long, optionnel)</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">#[</span><span class="cn">ORM</span>\<span class="cn">C</span>olumn(type<span class="ot">:</span> <span class="st">&#39;text&#39;</span><span class="ot">,</span> nullable<span class="ot">:</span> <span class="kw">true</span>)<span class="at">]</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="ot">?</span><span class="dt">string</span> <span class="va">$description</span> <span class="op">=</span> <span class="kw">null</span><span class="ot">;</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Prix du produit (nombre dÃ©cimal)</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">#[</span><span class="cn">ORM</span>\<span class="cn">C</span>olumn<span class="at">]</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="ot">?</span><span class="dt">float</span> <span class="va">$prix</span> <span class="op">=</span> <span class="kw">null</span><span class="ot">;</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Nom du fichier image (optionnel)</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">#[</span><span class="cn">ORM</span>\<span class="cn">C</span>olumn(length<span class="ot">:</span> <span class="dv">255</span><span class="ot">,</span> nullable<span class="ot">:</span> <span class="kw">true</span>)<span class="at">]</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="ot">?</span><span class="dt">string</span> <span class="va">$image</span> <span class="op">=</span> <span class="kw">null</span><span class="ot">;</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Produit actif ou non (disponible Ã  la vente)</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">#[</span><span class="cn">ORM</span>\<span class="cn">C</span>olumn<span class="at">]</span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="ot">?</span><span class="dt">bool</span> <span class="va">$actif</span> <span class="op">=</span> <span class="kw">true</span><span class="ot">;</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>    <span class="co">// === CHAMP STOCK ===</span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>    <span class="co">// QuantitÃ© disponible en stock</span></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Type int = nombre entier (0, 1, 2, 3...)</span></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Par dÃ©faut = 0 (aucun stock)</span></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">#[</span><span class="cn">ORM</span>\<span class="cn">C</span>olumn<span class="at">]</span></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="ot">?</span><span class="dt">int</span> <span class="va">$stock</span> <span class="op">=</span> <span class="dv">0</span><span class="ot">;</span></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Date de crÃ©ation (immuable)</span></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">#[</span><span class="cn">ORM</span>\<span class="cn">C</span>olumn<span class="at">]</span></span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="ot">?</span>\<span class="bu">DateTimeImmutable</span> <span class="va">$createdAt</span> <span class="op">=</span> <span class="kw">null</span><span class="ot">;</span></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Date de derniÃ¨re modification</span></span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">#[</span><span class="cn">ORM</span>\<span class="cn">C</span>olumn<span class="at">]</span></span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="ot">?</span>\<span class="bu">DateTimeImmutable</span> <span class="va">$updatedAt</span> <span class="op">=</span> <span class="kw">null</span><span class="ot">;</span></span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">function</span> <span class="bu">__construct</span>()</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>        <span class="va">$this</span>-&gt;createdAt <span class="op">=</span> <span class="kw">new</span> \<span class="bu">DateTimeImmutable</span>()<span class="ot">;</span></span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>        <span class="va">$this</span>-&gt;updatedAt <span class="op">=</span> <span class="kw">new</span> \<span class="bu">DateTimeImmutable</span>()<span class="ot">;</span></span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Getters et Setters classiques...</span></span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">function</span> getId()<span class="ot">:</span> <span class="ot">?</span><span class="dt">int</span></span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">$this</span>-&gt;id<span class="ot">;</span></span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">function</span> getNom()<span class="ot">:</span> <span class="ot">?</span><span class="dt">string</span></span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">$this</span>-&gt;nom<span class="ot">;</span></span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">function</span> setNom(<span class="dt">string</span> <span class="va">$nom</span>)<span class="ot">:</span> <span class="kw">static</span></span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a>        <span class="va">$this</span>-&gt;nom <span class="op">=</span> <span class="va">$nom</span><span class="ot">;</span></span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">$this</span><span class="ot">;</span></span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">function</span> getPrix()<span class="ot">:</span> <span class="ot">?</span><span class="dt">float</span></span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">$this</span>-&gt;prix<span class="ot">;</span></span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">function</span> setPrix(<span class="dt">float</span> <span class="va">$prix</span>)<span class="ot">:</span> <span class="kw">static</span></span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a>        <span class="va">$this</span>-&gt;prix <span class="op">=</span> <span class="va">$prix</span><span class="ot">;</span></span>
<span id="cb18-84"><a href="#cb18-84" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">$this</span><span class="ot">;</span></span>
<span id="cb18-85"><a href="#cb18-85" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-86"><a href="#cb18-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-87"><a href="#cb18-87" aria-hidden="true" tabindex="-1"></a>    <span class="co">// === MÃ‰THODES DE GESTION DU STOCK ===</span></span>
<span id="cb18-88"><a href="#cb18-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-89"><a href="#cb18-89" aria-hidden="true" tabindex="-1"></a>    <span class="co">/**</span></span>
<span id="cb18-90"><a href="#cb18-90" aria-hidden="true" tabindex="-1"></a><span class="co">     * RÃ©cupÃ©rer le stock disponible</span></span>
<span id="cb18-91"><a href="#cb18-91" aria-hidden="true" tabindex="-1"></a><span class="co">     * Retourne un nombre entier (ex: 10, 50, 0)</span></span>
<span id="cb18-92"><a href="#cb18-92" aria-hidden="true" tabindex="-1"></a><span class="co">     */</span></span>
<span id="cb18-93"><a href="#cb18-93" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">function</span> getStock()<span class="ot">:</span> <span class="ot">?</span><span class="dt">int</span></span>
<span id="cb18-94"><a href="#cb18-94" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb18-95"><a href="#cb18-95" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">$this</span>-&gt;stock<span class="ot">;</span></span>
<span id="cb18-96"><a href="#cb18-96" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-97"><a href="#cb18-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-98"><a href="#cb18-98" aria-hidden="true" tabindex="-1"></a>    <span class="co">/**</span></span>
<span id="cb18-99"><a href="#cb18-99" aria-hidden="true" tabindex="-1"></a><span class="co">     * DÃ©finir le stock disponible</span></span>
<span id="cb18-100"><a href="#cb18-100" aria-hidden="true" tabindex="-1"></a><span class="co">     * Exemple : setStock(100) pour mettre 100 produits en stock</span></span>
<span id="cb18-101"><a href="#cb18-101" aria-hidden="true" tabindex="-1"></a><span class="co">     */</span></span>
<span id="cb18-102"><a href="#cb18-102" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">function</span> setStock(<span class="dt">int</span> <span class="va">$stock</span>)<span class="ot">:</span> <span class="kw">static</span></span>
<span id="cb18-103"><a href="#cb18-103" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb18-104"><a href="#cb18-104" aria-hidden="true" tabindex="-1"></a>        <span class="va">$this</span>-&gt;stock <span class="op">=</span> <span class="va">$stock</span><span class="ot">;</span></span>
<span id="cb18-105"><a href="#cb18-105" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">$this</span><span class="ot">;</span></span>
<span id="cb18-106"><a href="#cb18-106" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-107"><a href="#cb18-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-108"><a href="#cb18-108" aria-hidden="true" tabindex="-1"></a>    <span class="co">/**</span></span>
<span id="cb18-109"><a href="#cb18-109" aria-hidden="true" tabindex="-1"></a><span class="co">     * VÃ©rifier s&#39;il reste du stock</span></span>
<span id="cb18-110"><a href="#cb18-110" aria-hidden="true" tabindex="-1"></a><span class="co">     * Retourne true si stock &gt; 0, false sinon</span></span>
<span id="cb18-111"><a href="#cb18-111" aria-hidden="true" tabindex="-1"></a><span class="co">     */</span></span>
<span id="cb18-112"><a href="#cb18-112" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">function</span> hasStock()<span class="ot">:</span> <span class="dt">bool</span></span>
<span id="cb18-113"><a href="#cb18-113" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb18-114"><a href="#cb18-114" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">$this</span>-&gt;stock <span class="op">&gt;</span> <span class="dv">0</span><span class="ot">;</span></span>
<span id="cb18-115"><a href="#cb18-115" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-116"><a href="#cb18-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-117"><a href="#cb18-117" aria-hidden="true" tabindex="-1"></a>    <span class="co">/**</span></span>
<span id="cb18-118"><a href="#cb18-118" aria-hidden="true" tabindex="-1"></a><span class="co">     * DÃ©crÃ©menter le stock (enlever une quantitÃ©)</span></span>
<span id="cb18-119"><a href="#cb18-119" aria-hidden="true" tabindex="-1"></a><span class="co">     * Exemple : decrementStock(2) enlÃ¨ve 2 produits du stock</span></span>
<span id="cb18-120"><a href="#cb18-120" aria-hidden="true" tabindex="-1"></a><span class="co">     * La fonction max(0, ...) empÃªche le stock de devenir nÃ©gatif</span></span>
<span id="cb18-121"><a href="#cb18-121" aria-hidden="true" tabindex="-1"></a><span class="co">     */</span></span>
<span id="cb18-122"><a href="#cb18-122" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">function</span> decrementStock(<span class="dt">int</span> <span class="va">$quantity</span>)<span class="ot">:</span> <span class="kw">static</span></span>
<span id="cb18-123"><a href="#cb18-123" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb18-124"><a href="#cb18-124" aria-hidden="true" tabindex="-1"></a>        <span class="co">// EmpÃªcher le stock de devenir nÃ©gatif</span></span>
<span id="cb18-125"><a href="#cb18-125" aria-hidden="true" tabindex="-1"></a>        <span class="va">$this</span>-&gt;stock <span class="op">=</span> <span class="fu">max</span>(<span class="dv">0</span><span class="ot">,</span> <span class="va">$this</span>-&gt;stock <span class="op">-</span> <span class="va">$quantity</span>)<span class="ot">;</span></span>
<span id="cb18-126"><a href="#cb18-126" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">$this</span><span class="ot">;</span></span>
<span id="cb18-127"><a href="#cb18-127" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-128"><a href="#cb18-128" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Points clÃ©s</strong> : - Le champ <code>stock</code> est de
type <code>INT</code> avec une valeur par dÃ©faut Ã  0 - La mÃ©thode
<code>hasStock()</code> vÃ©rifie rapidement si le produit est disponible
- La mÃ©thode <code>decrementStock()</code> diminue le stock de faÃ§on
sÃ©curisÃ©e (jamais nÃ©gatif)</p>
<hr />
<h2 id="migration-ajout-de-la-colonne-stock">13. Migration : Ajout de la
Colonne Stock</h2>
<p>Pour ajouter la colonne <code>stock</code> Ã  la table
<code>produit</code>, jâ€™ai crÃ©Ã© une migration Doctrine.</p>
<h3 id="code-de-la-migration">Code de la Migration</h3>
<div class="sourceCode" id="cb19"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;?php</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span>(strict_types<span class="op">=</span><span class="dv">1</span>)<span class="ot">;</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> <span class="cn">D</span>octrineMigrations<span class="ot">;</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="cn">D</span>octrine\<span class="cn">DBAL</span>\<span class="cn">S</span>chema\<span class="cn">S</span>chema<span class="ot">;</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="cn">D</span>octrine\<span class="cn">M</span>igrations\<span class="cn">A</span>bstractMigration<span class="ot">;</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"> * Migration pour ajouter la colonne &#39;stock&#39; Ã  la table produit</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co"> *</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co"> * PRINCIPE :</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co"> * - up() = Ajoute la colonne stock (exÃ©cutÃ© lors de php bin/console doctrine:migrations:migrate)</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co"> * - down() = Supprime la colonne stock (pour annuler la migration)</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="kw">final</span> <span class="kw">class</span> <span class="cn">V</span>ersion20251203150000 <span class="kw">extends</span> <span class="cn">A</span>bstractMigration</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">function</span> getDescription()<span class="ot">:</span> <span class="dt">string</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;Ajouter la colonne stock Ã  la table produit pour gÃ©rer les quantitÃ©s disponibles&#39;</span><span class="ot">;</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">// MÃ©thode exÃ©cutÃ©e pour appliquer la migration</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">function</span> up(<span class="cn">S</span>chema <span class="va">$schema</span>)<span class="ot">:</span> <span class="dt">void</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Ajouter la colonne &#39;stock&#39; de type INT (nombre entier)</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>        <span class="co">// NOT NULL = obligatoire</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>        <span class="co">// DEFAULT 0 = valeur par dÃ©faut Ã  0 si aucune valeur n&#39;est fournie</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>        <span class="va">$this</span>-&gt;addSql(<span class="st">&#39;ALTER TABLE produit ADD COLUMN stock INT NOT NULL DEFAULT 0&#39;</span>)<span class="ot">;</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>    <span class="co">// MÃ©thode exÃ©cutÃ©e pour annuler la migration</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">function</span> down(<span class="cn">S</span>chema <span class="va">$schema</span>)<span class="ot">:</span> <span class="dt">void</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Supprimer la colonne &#39;stock&#39;</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>        <span class="va">$this</span>-&gt;addSql(<span class="st">&#39;ALTER TABLE produit DROP COLUMN stock&#39;</span>)<span class="ot">;</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Commandes pour exÃ©cuter la migration</strong> :</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CrÃ©er une nouvelle migration</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="ex">php</span> bin/console make:migration</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Appliquer la migration</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="ex">php</span> bin/console doctrine:migrations:migrate</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># VÃ©rifier que la colonne a Ã©tÃ© ajoutÃ©e</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="ex">php</span> bin/console doctrine:schema:validate</span></code></pre></div>
<p><strong>RÃ©sultat en base de donnÃ©es</strong> :</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Table produit aprÃ¨s migration</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> produit (</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">id</span> <span class="dt">INT</span> AUTO_INCREMENT <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    nom <span class="dt">VARCHAR</span>(<span class="dv">255</span>) <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    description LONGTEXT <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    prix <span class="dt">DOUBLE</span> <span class="dt">PRECISION</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    image <span class="dt">VARCHAR</span>(<span class="dv">255</span>) <span class="kw">DEFAULT</span> <span class="kw">NULL</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    actif TINYINT(<span class="dv">1</span>) <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    stock <span class="dt">INT</span> <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">DEFAULT</span> <span class="dv">0</span>,  <span class="co">-- NOUVELLE COLONNE</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    created_at DATETIME <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    updated_at DATETIME <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">PRIMARY</span> <span class="kw">KEY</span>(<span class="kw">id</span>)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>);</span></code></pre></div>
<hr />
<h2 id="paniercontroller-gestion-complÃ¨te-du-panier">14.
PanierController : Gestion ComplÃ¨te du Panier</h2>
<p>Le <code>PanierController</code> gÃ¨re toutes les opÃ©rations liÃ©es au
panier : ajout, suppression, modification de quantitÃ© et validation de
commande.</p>
<h3 id="structure-du-panier-en-session">Structure du Panier en
Session</h3>
<p>Le panier est stockÃ© dans la <strong>session PHP</strong> :</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Structure d&#39;un article dans le panier</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="va">$panier</span> <span class="op">=</span> [</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;productId&#39;</span> =&gt; <span class="dv">1</span><span class="ot">,</span>    <span class="co">// ID du produit</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;quantity&#39;</span> =&gt; <span class="dv">2</span>      <span class="co">// QuantitÃ© demandÃ©e</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    ]<span class="ot">,</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;productId&#39;</span> =&gt; <span class="dv">5</span><span class="ot">,</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;quantity&#39;</span> =&gt; <span class="dv">1</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>]<span class="ot">;</span></span></code></pre></div>
<h3 id="mÃ©thode-afficher-le-panier">MÃ©thode : Afficher le Panier</h3>
<div class="sourceCode" id="cb23"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"> * Affiche la page panier avec tous les produits</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span><span class="cn">R</span>oute(<span class="st">&#39;/panier&#39;</span><span class="ot">,</span> name<span class="ot">:</span> <span class="st">&#39;app_panier&#39;</span>)<span class="at">]</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">function</span> index(<span class="cn">S</span>essionInterface <span class="va">$session</span><span class="ot">,</span> <span class="cn">P</span>roduitRepository <span class="va">$produitRepo</span>)<span class="ot">:</span> <span class="cn">R</span>esponse</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// RÃ©cupÃ©rer le panier depuis la session</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Si vide, retourner un tableau vide []</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="va">$panier</span> <span class="op">=</span> <span class="va">$session</span>-&gt;get(<span class="st">&#39;panier&#39;</span><span class="ot">,</span> [])<span class="ot">;</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Tableau qui contiendra les dÃ©tails complets des produits</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="va">$panierComplet</span> <span class="op">=</span> []<span class="ot">;</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="va">$total</span> <span class="op">=</span> <span class="dv">0</span><span class="ot">;</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Pour chaque article du panier</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">foreach</span> (<span class="va">$panier</span> <span class="kw">as</span> <span class="va">$item</span>) {</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>        <span class="co">// RÃ©cupÃ©rer le produit depuis la BDD par son ID</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">$produit</span> <span class="op">=</span> <span class="va">$produitRepo</span>-&gt;find(<span class="va">$item</span>[<span class="st">&#39;productId&#39;</span>])<span class="ot">;</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Si le produit existe toujours en BDD</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="va">$produit</span>) {</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Calculer le sous-total pour cet article</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>            <span class="va">$sousTotal</span> <span class="op">=</span> <span class="va">$produit</span>-&gt;getPrix() <span class="op">*</span> <span class="va">$item</span>[<span class="st">&#39;quantity&#39;</span>]<span class="ot">;</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Ajouter les dÃ©tails complets</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>            <span class="va">$panierComplet</span>[] <span class="op">=</span> [</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;productId&#39;</span> =&gt; <span class="va">$produit</span>-&gt;getId()<span class="ot">,</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;name&#39;</span> =&gt; <span class="va">$produit</span>-&gt;getNom()<span class="ot">,</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;price&#39;</span> =&gt; <span class="va">$produit</span>-&gt;getPrix()<span class="ot">,</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;quantity&#39;</span> =&gt; <span class="va">$item</span>[<span class="st">&#39;quantity&#39;</span>]<span class="ot">,</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;image&#39;</span> =&gt; <span class="va">$produit</span>-&gt;getImage()<span class="ot">,</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;total&#39;</span> =&gt; <span class="va">$sousTotal</span><span class="ot">,</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;stock&#39;</span> =&gt; <span class="va">$produit</span>-&gt;getStock() <span class="co">// Stock disponible</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>            ]<span class="ot">;</span></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Ajouter au total gÃ©nÃ©ral</span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>            <span class="va">$total</span> <span class="op">+=</span> <span class="va">$sousTotal</span><span class="ot">;</span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Afficher la page panier avec les donnÃ©es</span></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">$this</span>-&gt;render(<span class="st">&#39;panier/index.html.twig&#39;</span><span class="ot">,</span> [</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;panier&#39;</span> =&gt; <span class="va">$panierComplet</span><span class="ot">,</span></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;total&#39;</span> =&gt; <span class="va">$total</span></span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>    ])<span class="ot">;</span></span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Explication</strong> : - On rÃ©cupÃ¨re les IDs des produits
depuis la session - Pour chaque ID, on rÃ©cupÃ¨re les donnÃ©es complÃ¨tes
depuis la BDD (prix, nom, image) - On calcule le total du panier -
<strong>Avantage</strong> : Les prix sont toujours Ã  jour (si un admin
modifie le prix, le panier sera recalculÃ©)</p>
<h3 id="mÃ©thode-ajouter-un-produit-au-panier">MÃ©thode : Ajouter un
Produit au Panier</h3>
<div class="sourceCode" id="cb24"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"> * Ajoute un produit au panier avec vÃ©rification du stock</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span><span class="cn">R</span>oute(<span class="st">&#39;/panier/ajouter&#39;</span><span class="ot">,</span> name<span class="ot">:</span> <span class="st">&#39;app_panier_ajouter&#39;</span><span class="ot">,</span> methods<span class="ot">:</span> [<span class="st">&#39;POST&#39;</span>])<span class="at">]</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">function</span> ajouter(</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">R</span>equest <span class="va">$request</span><span class="ot">,</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="cn">S</span>essionInterface <span class="va">$session</span><span class="ot">,</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="cn">P</span>roduitRepository <span class="va">$produitRepo</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>)<span class="ot">:</span> <span class="cn">R</span>esponse {</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// RÃ©cupÃ©rer l&#39;ID du produit depuis le formulaire</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// (int) = conversion en nombre entier pour sÃ©curiser</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="va">$productId</span> <span class="op">=</span> (<span class="dt">int</span>) <span class="va">$request</span>-&gt;request-&gt;get(<span class="st">&#39;product_id&#39;</span>)<span class="ot">;</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">// RÃ©cupÃ©rer la quantitÃ© demandÃ©e (par dÃ©faut 1)</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    <span class="va">$quantite</span> <span class="op">=</span> (<span class="dt">int</span>) <span class="va">$request</span>-&gt;request-&gt;get(<span class="st">&#39;quantite&#39;</span><span class="ot">,</span> <span class="dv">1</span>)<span class="ot">;</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">// RÃ©cupÃ©rer le produit depuis la BDD</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    <span class="va">$produit</span> <span class="op">=</span> <span class="va">$produitRepo</span>-&gt;find(<span class="va">$productId</span>)<span class="ot">;</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">// VÃ©rifier que le produit existe</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span><span class="va">$produit</span>) {</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">$this</span>-&gt;addFlash(<span class="st">&#39;error&#39;</span><span class="ot">,</span> <span class="st">&#39;Produit introuvable !&#39;</span>)<span class="ot">;</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">$this</span>-&gt;redirectToRoute(<span class="st">&#39;app_panier&#39;</span>)<span class="ot">;</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>    <span class="co">// VÃ©rifier que le produit est actif (disponible Ã  la vente)</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span><span class="va">$produit</span>-&gt;isActif()) {</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>        <span class="va">$this</span>-&gt;addFlash(<span class="st">&#39;error&#39;</span><span class="ot">,</span> <span class="st">&#39;Ce produit n</span><span class="sc">\&#39;</span><span class="st">est plus disponible.&#39;</span>)<span class="ot">;</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">$this</span>-&gt;redirectToRoute(<span class="st">&#39;app_produit&#39;</span>)<span class="ot">;</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">// RÃ©cupÃ©rer le panier actuel</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>    <span class="va">$panier</span> <span class="op">=</span> <span class="va">$session</span>-&gt;get(<span class="st">&#39;panier&#39;</span><span class="ot">,</span> [])<span class="ot">;</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Chercher si le produit est dÃ©jÃ  dans le panier</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>    <span class="va">$produitExiste</span> <span class="op">=</span> <span class="kw">false</span><span class="ot">;</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">foreach</span> (<span class="va">$panier</span> <span class="kw">as</span> <span class="va">$key</span> =&gt; <span class="va">$item</span>) {</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="va">$item</span>[<span class="st">&#39;productId&#39;</span>] <span class="op">===</span> <span class="va">$productId</span>) {</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Calculer la nouvelle quantitÃ© totale</span></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>            <span class="va">$nouvelleQuantite</span> <span class="op">=</span> <span class="va">$item</span>[<span class="st">&#39;quantity&#39;</span>] <span class="op">+</span> <span class="va">$quantite</span><span class="ot">;</span></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>            <span class="co">// === VÃ‰RIFICATION DU STOCK ===</span></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>            <span class="co">// VÃ©rifier qu&#39;on ne dÃ©passe pas le stock disponible</span></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="va">$nouvelleQuantite</span> <span class="op">&gt;</span> <span class="va">$produit</span>-&gt;getStock()) {</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>                <span class="va">$this</span>-&gt;addFlash(<span class="st">&#39;error&#39;</span><span class="ot">,</span> <span class="st">&quot;Stock insuffisant ! Seulement </span>{<span class="va">$produit</span>-&gt;getStock()}<span class="st"> disponible(s).&quot;</span>)<span class="ot">;</span></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">$this</span>-&gt;redirectToRoute(<span class="st">&#39;app_panier&#39;</span>)<span class="ot">;</span></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Mettre Ã  jour la quantitÃ©</span></span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>            <span class="va">$panier</span>[<span class="va">$key</span>][<span class="st">&#39;quantity&#39;</span>] <span class="op">=</span> <span class="va">$nouvelleQuantite</span><span class="ot">;</span></span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>            <span class="va">$produitExiste</span> <span class="op">=</span> <span class="kw">true</span><span class="ot">;</span></span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span><span class="ot">;</span></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Si le produit n&#39;est pas dans le panier, l&#39;ajouter</span></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span><span class="va">$produitExiste</span>) {</span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>        <span class="co">// VÃ©rifier le stock avant d&#39;ajouter</span></span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="va">$quantite</span> <span class="op">&gt;</span> <span class="va">$produit</span>-&gt;getStock()) {</span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>            <span class="va">$this</span>-&gt;addFlash(<span class="st">&#39;error&#39;</span><span class="ot">,</span> <span class="st">&quot;Stock insuffisant ! Seulement </span>{<span class="va">$produit</span>-&gt;getStock()}<span class="st"> disponible(s).&quot;</span>)<span class="ot">;</span></span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">$this</span>-&gt;redirectToRoute(<span class="st">&#39;app_produit&#39;</span>)<span class="ot">;</span></span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Ajouter au panier</span></span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>        <span class="va">$panier</span>[] <span class="op">=</span> [</span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;productId&#39;</span> =&gt; <span class="va">$productId</span><span class="ot">,</span></span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;quantity&#39;</span> =&gt; <span class="va">$quantite</span></span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a>        ]<span class="ot">;</span></span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Sauvegarder le panier en session</span></span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a>    <span class="va">$session</span>-&gt;set(<span class="st">&#39;panier&#39;</span><span class="ot">,</span> <span class="va">$panier</span>)<span class="ot">;</span></span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Message de confirmation</span></span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a>    <span class="va">$this</span>-&gt;addFlash(<span class="st">&#39;success&#39;</span><span class="ot">,</span> <span class="st">&quot;</span>{<span class="va">$produit</span>-&gt;getNom()}<span class="st"> ajoutÃ© au panier !&quot;</span>)<span class="ot">;</span></span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Rediriger vers la page d&#39;origine</span></span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">$this</span>-&gt;redirectToRoute(<span class="st">&#39;app_produit&#39;</span>)<span class="ot">;</span></span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Points clÃ©s</strong> : - VÃ©rification du stock
<strong>avant</strong> dâ€™ajouter au panier - Si le produit est dÃ©jÃ  dans
le panier, on met Ã  jour la quantitÃ© - Message dâ€™erreur explicite si
stock insuffisant - Le panier est sauvegardÃ© en session</p>
<h3 id="mÃ©thode-valider-le-paiement-et-dÃ©crÃ©menter-le-stock">MÃ©thode :
Valider le Paiement et DÃ©crÃ©menter le Stock</h3>
<div class="sourceCode" id="cb25"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"> * Valide le paiement, enregistre la commande et dÃ©crÃ©mente le stock</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span><span class="cn">R</span>oute(<span class="st">&#39;/panier/paiement-effectue&#39;</span><span class="ot">,</span> name<span class="ot">:</span> <span class="st">&#39;app_panier_paiement_effectue&#39;</span><span class="ot">,</span> methods<span class="ot">:</span> [<span class="st">&#39;POST&#39;</span>])<span class="at">]</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">function</span> paiementEffectue(</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">S</span>essionInterface <span class="va">$session</span><span class="ot">,</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="cn">E</span>ntityManagerInterface <span class="va">$em</span><span class="ot">,</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="cn">P</span>roduitRepository <span class="va">$produitRepo</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>)<span class="ot">:</span> <span class="cn">R</span>esponse {</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// RÃ©cupÃ©rer le panier et l&#39;utilisateur</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    <span class="va">$panier</span> <span class="op">=</span> <span class="va">$session</span>-&gt;get(<span class="st">&#39;panier&#39;</span><span class="ot">,</span> [])<span class="ot">;</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="va">$user</span> <span class="op">=</span> <span class="va">$session</span>-&gt;get(<span class="st">&#39;user&#39;</span>)<span class="ot">;</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">// VÃ©rifier que le panier n&#39;est pas vide</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="kw">empty</span>(<span class="va">$panier</span>)) {</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">$this</span>-&gt;addFlash(<span class="st">&#39;error&#39;</span><span class="ot">,</span> <span class="st">&#39;Votre panier est vide !&#39;</span>)<span class="ot">;</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">$this</span>-&gt;redirectToRoute(<span class="st">&#39;app_panier&#39;</span>)<span class="ot">;</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span> {</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Pour chaque article du panier</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">foreach</span> (<span class="va">$panier</span> <span class="kw">as</span> <span class="va">$item</span>) {</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>            <span class="co">// RÃ©cupÃ©rer le produit depuis la BDD</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>            <span class="va">$produit</span> <span class="op">=</span> <span class="va">$produitRepo</span>-&gt;find(<span class="va">$item</span>[<span class="st">&#39;productId&#39;</span>])<span class="ot">;</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="op">!</span><span class="va">$produit</span>) {</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span><span class="ot">;</span> <span class="co">// Passer au suivant si produit introuvable</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>            <span class="co">// === VÃ‰RIFICATION FINALE DU STOCK ===</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Important : vÃ©rifier Ã  nouveau car le stock peut avoir changÃ©</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="va">$item</span>[<span class="st">&#39;quantity&#39;</span>] <span class="op">&gt;</span> <span class="va">$produit</span>-&gt;getStock()) {</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>                <span class="va">$this</span>-&gt;addFlash(<span class="st">&#39;error&#39;</span><span class="ot">,</span> <span class="st">&quot;Stock insuffisant pour </span>{<span class="va">$produit</span>-&gt;getNom()}<span class="st">&quot;</span>)<span class="ot">;</span></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">$this</span>-&gt;redirectToRoute(<span class="st">&#39;app_panier&#39;</span>)<span class="ot">;</span></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>            <span class="co">// CrÃ©er une nouvelle commande</span></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>            <span class="va">$commande</span> <span class="op">=</span> <span class="kw">new</span> <span class="cn">C</span>ommande()<span class="ot">;</span></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>            <span class="va">$commande</span>-&gt;setNomClient(<span class="va">$user</span> <span class="ot">?</span> <span class="va">$user</span>[<span class="st">&#39;nom&#39;</span>] <span class="ot">:</span> <span class="st">&#39;Client anonyme&#39;</span>)<span class="ot">;</span></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>            <span class="va">$commande</span>-&gt;setProduit(<span class="va">$produit</span>-&gt;getNom())<span class="ot">;</span></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>            <span class="va">$commande</span>-&gt;setQuantite(<span class="va">$item</span>[<span class="st">&#39;quantity&#39;</span>])<span class="ot">;</span></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>            <span class="va">$commande</span>-&gt;setPrix(<span class="va">$produit</span>-&gt;getPrix())<span class="ot">;</span></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>            <span class="va">$commande</span>-&gt;setImage(<span class="va">$produit</span>-&gt;getImage())<span class="ot">;</span></span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>            <span class="va">$commande</span>-&gt;setDateCommande(<span class="kw">new</span> \<span class="bu">DateTime</span>())<span class="ot">;</span></span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>            <span class="co">// === DÃ‰CRÃ‰MENTATION DU STOCK ===</span></span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Enlever la quantitÃ© achetÃ©e du stock</span></span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>            <span class="va">$produit</span>-&gt;decrementStock(<span class="va">$item</span>[<span class="st">&#39;quantity&#39;</span>])<span class="ot">;</span></span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>            <span class="va">$produit</span>-&gt;setUpdatedAt(<span class="kw">new</span> \<span class="bu">DateTimeImmutable</span>())<span class="ot">;</span></span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>            <span class="co">// persist() = prÃ©parer l&#39;enregistrement en BDD</span></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>            <span class="va">$em</span>-&gt;persist(<span class="va">$commande</span>)<span class="ot">;</span></span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>            <span class="va">$em</span>-&gt;persist(<span class="va">$produit</span>)<span class="ot">;</span> <span class="co">// Important : sauvegarder le nouveau stock</span></span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>        <span class="co">// flush() = exÃ©cuter tous les enregistrements en BDD</span></span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>        <span class="va">$em</span>-&gt;<span class="fu">flush</span>()<span class="ot">;</span></span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Vider le panier aprÃ¨s succÃ¨s</span></span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>        <span class="va">$session</span>-&gt;remove(<span class="st">&#39;panier&#39;</span>)<span class="ot">;</span></span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>        <span class="va">$this</span>-&gt;addFlash(<span class="st">&#39;success&#39;</span><span class="ot">,</span> <span class="st">&#39;Paiement effectuÃ© et commande enregistrÃ©e avec succÃ¨s !&#39;</span>)<span class="ot">;</span></span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">catch</span> (\<span class="bu">Exception</span> <span class="va">$e</span>) {</span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a>        <span class="co">// En cas d&#39;erreur</span></span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a>        <span class="va">$this</span>-&gt;addFlash(<span class="st">&#39;error&#39;</span><span class="ot">,</span> <span class="st">&#39;Erreur lors de l</span><span class="sc">\&#39;</span><span class="st">enregistrement : &#39;</span> <span class="op">.</span> <span class="va">$e</span>-&gt;getMessage())<span class="ot">;</span></span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">$this</span>-&gt;redirectToRoute(<span class="st">&#39;app_panier&#39;</span>)<span class="ot">;</span></span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Points clÃ©s</strong> : - Double vÃ©rification du stock (avant
ajout panier + avant validation) - Utilisation de
<code>decrementStock()</code> pour diminuer le stock de faÃ§on sÃ©curisÃ©e
- Transaction atomique : tout est enregistrÃ© ensemble avec
<code>flush()</code> - En cas dâ€™erreur, rien nâ€™est modifiÃ© (rollback
automatique)</p>
<hr />
<h2 id="admincontroller-gestion-des-produits-et-du-stock">15.
AdminController : Gestion des Produits et du Stock</h2>
<p>Le dashboard admin permet de crÃ©er, modifier et supprimer des
produits, ainsi que de gÃ©rer le stock.</p>
<h3 id="mÃ©thode-de-vÃ©rification-admin">MÃ©thode de VÃ©rification
Admin</h3>
<div class="sourceCode" id="cb26"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"> * VÃ©rifie si l&#39;utilisateur connectÃ© est admin</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"> * Retourne true si admin, false sinon</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="kw">private</span> <span class="kw">function</span> checkAdmin(<span class="cn">S</span>essionInterface <span class="va">$session</span>)<span class="ot">:</span> <span class="dt">bool</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="va">$user</span> <span class="op">=</span> <span class="va">$session</span>-&gt;get(<span class="st">&#39;user&#39;</span>)<span class="ot">;</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Retourne true si l&#39;utilisateur est connectÃ© ET a le rÃ´le admin</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">$user</span> <span class="op">&amp;&amp;</span> <span class="kw">isset</span>(<span class="va">$user</span>[<span class="st">&#39;role&#39;</span>]) <span class="op">&amp;&amp;</span> <span class="va">$user</span>[<span class="st">&#39;role&#39;</span>] <span class="op">===</span> <span class="st">&#39;admin&#39;</span><span class="ot">;</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h3 id="mÃ©thode-crÃ©er-un-nouveau-produit">MÃ©thode : CrÃ©er un Nouveau
Produit</h3>
<div class="sourceCode" id="cb27"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"> * CrÃ©er un nouveau produit avec stock</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span><span class="cn">R</span>oute(<span class="st">&#39;/admin/produit/new&#39;</span><span class="ot">,</span> name<span class="ot">:</span> <span class="st">&#39;app_admin_produit_new&#39;</span><span class="ot">,</span> methods<span class="ot">:</span> [<span class="st">&#39;GET&#39;</span><span class="ot">,</span> <span class="st">&#39;POST&#39;</span>])<span class="at">]</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">function</span> <span class="kw">new</span>(</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">R</span>equest <span class="va">$request</span><span class="ot">,</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="cn">E</span>ntityManagerInterface <span class="va">$entityManager</span><span class="ot">,</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="cn">S</span>luggerInterface <span class="va">$slugger</span><span class="ot">,</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="cn">S</span>essionInterface <span class="va">$session</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>)<span class="ot">:</span> <span class="cn">R</span>esponse {</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// VÃ©rifier si l&#39;utilisateur est admin</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span><span class="va">$this</span>-&gt;checkAdmin(<span class="va">$session</span>)) {</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">$this</span>-&gt;addFlash(<span class="st">&#39;error&#39;</span><span class="ot">,</span> <span class="st">&#39;AccÃ¨s refusÃ©&#39;</span>)<span class="ot">;</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">$this</span>-&gt;redirectToRoute(<span class="st">&#39;app_home&#39;</span>)<span class="ot">;</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="va">$request</span>-&gt;isMethod(<span class="st">&#39;POST&#39;</span>)) {</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">$produit</span> <span class="op">=</span> <span class="kw">new</span> <span class="cn">P</span>roduit()<span class="ot">;</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>        <span class="va">$produit</span>-&gt;setNom(<span class="va">$request</span>-&gt;request-&gt;get(<span class="st">&#39;nom&#39;</span>))<span class="ot">;</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">$produit</span>-&gt;setDescription(<span class="va">$request</span>-&gt;request-&gt;get(<span class="st">&#39;description&#39;</span>))<span class="ot">;</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">$produit</span>-&gt;setPrix(<span class="dt">(float)</span> <span class="va">$request</span>-&gt;request-&gt;get(<span class="st">&#39;prix&#39;</span>))<span class="ot">;</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">$produit</span>-&gt;setActif(<span class="va">$request</span>-&gt;request-&gt;get(<span class="st">&#39;actif&#39;</span>) <span class="op">===</span> <span class="st">&#39;on&#39;</span>)<span class="ot">;</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">// === RÃ‰CUPÃ‰RER LE STOCK DEPUIS LE FORMULAIRE ===</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>        <span class="co">// (int) pour convertir en nombre entier</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Par dÃ©faut 0 si aucune valeur</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>        <span class="va">$produit</span>-&gt;setStock((<span class="dt">int</span>) <span class="va">$request</span>-&gt;request-&gt;get(<span class="st">&#39;stock&#39;</span><span class="ot">,</span> <span class="dv">0</span>))<span class="ot">;</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>        <span class="va">$produit</span>-&gt;setUpdatedAt(<span class="kw">new</span> \<span class="bu">DateTimeImmutable</span>())<span class="ot">;</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Gestion de l&#39;image (upload)</span></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>        <span class="va">$imageFile</span> <span class="op">=</span> <span class="va">$request</span>-&gt;files-&gt;get(<span class="st">&#39;image&#39;</span>)<span class="ot">;</span></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="va">$imageFile</span> <span class="op">&amp;&amp;</span> <span class="va">$imageFile</span>-&gt;getClientOriginalName()) {</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>            <span class="va">$originalFilename</span> <span class="op">=</span> <span class="fu">pathinfo</span>(<span class="va">$imageFile</span>-&gt;getClientOriginalName()<span class="ot">,</span> <span class="cn">PATHINFO_FILENAME</span>)<span class="ot">;</span></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>            <span class="va">$safeFilename</span> <span class="op">=</span> <span class="va">$slugger</span>-&gt;slug(<span class="va">$originalFilename</span>)<span class="ot">;</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>            <span class="va">$newFilename</span> <span class="op">=</span> <span class="va">$safeFilename</span> <span class="op">.</span> <span class="st">&#39;-&#39;</span> <span class="op">.</span> <span class="fu">uniqid</span>() <span class="op">.</span> <span class="st">&#39;.&#39;</span> <span class="op">.</span> <span class="va">$imageFile</span>-&gt;guessExtension()<span class="ot">;</span></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span> {</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>                <span class="va">$imageFile</span>-&gt;move(</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>                    <span class="va">$this</span>-&gt;getParameter(<span class="st">&#39;produits_directory&#39;</span>)<span class="ot">,</span></span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>                    <span class="va">$newFilename</span></span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>                )<span class="ot">;</span></span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>                <span class="va">$produit</span>-&gt;setImage(<span class="va">$newFilename</span>)<span class="ot">;</span></span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>            } <span class="cf">catch</span> (\<span class="bu">Exception</span> <span class="va">$e</span>) {</span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>                <span class="va">$this</span>-&gt;addFlash(<span class="st">&#39;error&#39;</span><span class="ot">,</span> <span class="st">&#39;Erreur lors du tÃ©lÃ©chargement de l</span><span class="sc">\&#39;</span><span class="st">image&#39;</span>)<span class="ot">;</span></span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>        <span class="va">$entityManager</span>-&gt;persist(<span class="va">$produit</span>)<span class="ot">;</span></span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>        <span class="va">$entityManager</span>-&gt;<span class="fu">flush</span>()<span class="ot">;</span></span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>        <span class="va">$this</span>-&gt;addFlash(<span class="st">&#39;success&#39;</span><span class="ot">,</span> <span class="st">&#39;Produit crÃ©Ã© avec succÃ¨s !&#39;</span>)<span class="ot">;</span></span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">$this</span>-&gt;redirectToRoute(<span class="st">&#39;app_admin_dashboard&#39;</span>)<span class="ot">;</span></span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">$this</span>-&gt;render(<span class="st">&#39;admin/produit_form.html.twig&#39;</span><span class="ot">,</span> [</span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;produit&#39;</span> =&gt; <span class="kw">null</span><span class="ot">,</span></span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;action&#39;</span> =&gt; <span class="st">&#39;CrÃ©er&#39;</span></span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a>    ])<span class="ot">;</span></span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Explication</strong> : - Le champ <code>stock</code> est
rÃ©cupÃ©rÃ© depuis le formulaire avec
<code>$request-&gt;request-&gt;get('stock', 0)</code> - Conversion en
<code>int</code> pour garantir un nombre entier - Valeur par dÃ©faut 0 si
non renseignÃ©</p>
<hr />
<h2 id="templates-twig-affichage-avec-gestion-du-stock">16. Templates
Twig : Affichage avec Gestion du Stock</h2>
<h3 id="template-page-panier-panierindex.html.twig">Template : Page
Panier (panier/index.html.twig)</h3>
<pre class="twig"><code>{% extends &#39;base.html.twig&#39; %}

{% block body %}
    &lt;div class=&quot;container&quot;&gt;
        &lt;h1&gt;Mon Panier&lt;/h1&gt;

        {# Si le panier est vide #}
        {% if panier is empty %}
            &lt;div class=&quot;empty-cart&quot;&gt;
                &lt;p&gt;Votre panier est vide.&lt;/p&gt;
                &lt;a href=&quot;{{ path(&#39;app_produit&#39;) }}&quot; class=&quot;btn btn-primary&quot;&gt;
                    Continuer mes achats
                &lt;/a&gt;
            &lt;/div&gt;
        {% else %}
            {# Afficher les articles du panier #}
            &lt;div class=&quot;cart-items&quot;&gt;
                {% for item in panier %}
                    &lt;div class=&quot;cart-item&quot;&gt;
                        {# Image du produit #}
                        &lt;div class=&quot;item-image&quot;&gt;
                            {% if item.image %}
                                &lt;img src=&quot;{{ asset(&#39;images/produits/&#39; ~ item.image) }}&quot;
                                     alt=&quot;{{ item.name }}&quot;&gt;
                            {% else %}
                                &lt;img src=&quot;{{ asset(&#39;images/hero3.jpg&#39;) }}&quot;
                                     alt=&quot;{{ item.name }}&quot;&gt;
                            {% endif %}
                        &lt;/div&gt;

                        {# Informations du produit #}
                        &lt;div class=&quot;item-info&quot;&gt;
                            &lt;h3&gt;{{ item.name }}&lt;/h3&gt;
                            &lt;p class=&quot;item-details&quot;&gt;
                                &lt;strong&gt;Prix unitaire:&lt;/strong&gt; {{ item.price }}â‚¬&lt;br&gt;
                                &lt;strong&gt;QuantitÃ©:&lt;/strong&gt; {{ item.quantity }}&lt;br&gt;
                                {# Afficher le stock restant #}
                                &lt;strong&gt;Stock restant:&lt;/strong&gt;
                                &lt;span class=&quot;stock-badge&quot;&gt;{{ item.stock }}&lt;/span&gt;
                            &lt;/p&gt;
                        &lt;/div&gt;

                        {# Prix et actions #}
                        &lt;div class=&quot;item-actions&quot;&gt;
                            {# Sous-total pour cet article #}
                            &lt;span class=&quot;price&quot;&gt;
                                {{ item.total|number_format(2, &#39;,&#39;, &#39; &#39;) }}â‚¬
                            &lt;/span&gt;

                            {# Boutons quantitÃ© + et - #}
                            &lt;div class=&quot;quantity-controls&quot;&gt;
                                &lt;a href=&quot;{{ path(&#39;app_panier_augmenter&#39;, {productId: item.productId}) }}&quot;
                                   class=&quot;btn btn-outline-secondary btn-quantity&quot;
                                   title=&quot;Augmenter la quantitÃ©&quot;&gt;
                                    &lt;i class=&quot;fas fa-plus&quot;&gt;&lt;/i&gt;
                                &lt;/a&gt;
                                &lt;a href=&quot;{{ path(&#39;app_panier_diminuer&#39;, {productId: item.productId}) }}&quot;
                                   class=&quot;btn btn-outline-secondary btn-quantity&quot;
                                   title=&quot;Diminuer la quantitÃ©&quot;&gt;
                                    &lt;i class=&quot;fas fa-minus&quot;&gt;&lt;/i&gt;
                                &lt;/a&gt;
                                {# Bouton supprimer #}
                                &lt;a href=&quot;{{ path(&#39;app_panier_supprimer&#39;, {productId: item.productId}) }}&quot;
                                   class=&quot;btn btn-danger btn-quantity&quot;
                                   onclick=&quot;return confirm(&#39;Supprimer {{ item.name }} du panier ?&#39;)&quot;
                                   title=&quot;Supprimer&quot;&gt;
                                    &lt;i class=&quot;fas fa-trash&quot;&gt;&lt;/i&gt;
                                &lt;/a&gt;
                            &lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                {% endfor %}
            &lt;/div&gt;

            {# RÃ©sumÃ© du panier #}
            &lt;div class=&quot;cart-summary&quot;&gt;
                &lt;div class=&quot;total&quot;&gt;
                    &lt;h3&gt;Total: {{ total|number_format(2, &#39;,&#39;, &#39; &#39;) }}â‚¬&lt;/h3&gt;
                &lt;/div&gt;

                {# Bouton passer commande #}
                &lt;button type=&quot;button&quot;
                        class=&quot;btn btn-success&quot;
                        data-bs-toggle=&quot;modal&quot;
                        data-bs-target=&quot;#paymentModal&quot;&gt;
                    &lt;i class=&quot;fas fa-shopping-cart&quot;&gt;&lt;/i&gt; Passer commande
                &lt;/button&gt;
            &lt;/div&gt;

            {# Modale de confirmation de paiement #}
            &lt;div class=&quot;modal fade&quot; id=&quot;paymentModal&quot; tabindex=&quot;-1&quot;&gt;
                &lt;div class=&quot;modal-dialog modal-dialog-centered&quot;&gt;
                    &lt;div class=&quot;modal-content&quot;&gt;
                        &lt;div class=&quot;modal-header&quot;&gt;
                            &lt;h5 class=&quot;modal-title&quot;&gt;Confirmer la commande&lt;/h5&gt;
                            &lt;button type=&quot;button&quot; class=&quot;btn-close&quot; data-bs-dismiss=&quot;modal&quot;&gt;&lt;/button&gt;
                        &lt;/div&gt;
                        &lt;div class=&quot;modal-body text-center&quot;&gt;
                            &lt;p&gt;ÃŠtes-vous sÃ»r de vouloir valider cette commande ?&lt;/p&gt;
                            &lt;p&gt;&lt;strong&gt;Total: {{ total|number_format(2, &#39;,&#39;, &#39; &#39;) }}â‚¬&lt;/strong&gt;&lt;/p&gt;
                        &lt;/div&gt;
                        &lt;div class=&quot;modal-footer&quot;&gt;
                            &lt;button type=&quot;button&quot; class=&quot;btn btn-secondary&quot; data-bs-dismiss=&quot;modal&quot;&gt;
                                Annuler
                            &lt;/button&gt;
                            {# Formulaire de validation #}
                            &lt;form action=&quot;{{ path(&#39;app_panier_paiement_effectue&#39;) }}&quot;
                                  method=&quot;POST&quot; style=&quot;display: inline;&quot;&gt;
                                &lt;button type=&quot;submit&quot; class=&quot;btn btn-success&quot;&gt;
                                    &lt;i class=&quot;fas fa-check&quot;&gt;&lt;/i&gt; Valider le paiement
                                &lt;/button&gt;
                            &lt;/form&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        {% endif %}
    &lt;/div&gt;
{% endblock %}</code></pre>
<p><strong>Points clÃ©s</strong> : - Affichage du stock restant pour
chaque produit :
<code>&lt;span class="stock-badge"&gt;{{ item.stock }}&lt;/span&gt;</code>
- Utilisation de <code>number_format</code> pour formater les prix (2
dÃ©cimales, virgule, espace pour milliers) - Modale Bootstrap pour
confirmer la commande</p>
<h3 id="template-dashboard-admin-admindashboard.html.twig">Template :
Dashboard Admin (admin/dashboard.html.twig)</h3>
<pre class="twig"><code>{% extends &#39;base.html.twig&#39; %}

{% block body %}
    &lt;div class=&quot;container mt-4&quot;&gt;
        &lt;h1&gt;Dashboard Admin&lt;/h1&gt;

        &lt;div class=&quot;table-responsive&quot;&gt;
            &lt;table class=&quot;table table-striped&quot;&gt;
                &lt;thead&gt;
                    &lt;tr&gt;
                        &lt;th&gt;ID&lt;/th&gt;
                        &lt;th&gt;Image&lt;/th&gt;
                        &lt;th&gt;Nom&lt;/th&gt;
                        &lt;th&gt;Prix&lt;/th&gt;
                        &lt;th&gt;Stock&lt;/th&gt;
                        &lt;th&gt;Statut&lt;/th&gt;
                        &lt;th&gt;Actions&lt;/th&gt;
                    &lt;/tr&gt;
                &lt;/thead&gt;
                &lt;tbody&gt;
                    {% for produit in produits %}
                        &lt;tr&gt;
                            &lt;td&gt;{{ produit.id }}&lt;/td&gt;
                            &lt;td&gt;
                                {% if produit.image %}
                                    &lt;img src=&quot;{{ asset(&#39;images/produits/&#39; ~ produit.image) }}&quot;
                                         alt=&quot;{{ produit.nom }}&quot;
                                         style=&quot;width: 50px; height: 50px; object-fit: cover;&quot;&gt;
                                {% endif %}
                            &lt;/td&gt;
                            &lt;td&gt;{{ produit.nom }}&lt;/td&gt;
                            &lt;td&gt;{{ produit.prix|number_format(2, &#39;,&#39;, &#39; &#39;) }}â‚¬&lt;/td&gt;
                            &lt;td&gt;
                                {# Badge colorÃ© selon la quantitÃ© en stock #}
                                {% if produit.stock == 0 %}
                                    {# Rupture de stock = rouge #}
                                    &lt;span class=&quot;badge bg-danger&quot;&gt;Rupture&lt;/span&gt;
                                {% elseif produit.stock &lt; 10 %}
                                    {# Stock faible (1-9) = orange #}
                                    &lt;span class=&quot;badge bg-warning text-dark&quot;&gt;
                                        {{ produit.stock }} (Faible)
                                    &lt;/span&gt;
                                {% else %}
                                    {# Stock ok (â‰¥10) = vert #}
                                    &lt;span class=&quot;badge bg-success&quot;&gt;{{ produit.stock }}&lt;/span&gt;
                                {% endif %}
                            &lt;/td&gt;
                            &lt;td&gt;
                                &lt;span class=&quot;badge bg-{{ produit.actif ? &#39;success&#39; : &#39;danger&#39; }}&quot;&gt;
                                    {{ produit.actif ? &#39;Actif&#39; : &#39;Inactif&#39; }}
                                &lt;/span&gt;
                            &lt;/td&gt;
                            &lt;td&gt;
                                {# Bouton modifier #}
                                &lt;a href=&quot;{{ path(&#39;app_admin_produit_edit&#39;, {id: produit.id}) }}&quot;
                                   class=&quot;btn btn-sm btn-warning&quot;&gt;
                                    &lt;i class=&quot;fas fa-edit&quot;&gt;&lt;/i&gt;
                                &lt;/a&gt;
                                {# Bouton supprimer #}
                                &lt;form method=&quot;POST&quot;
                                      action=&quot;{{ path(&#39;app_admin_produit_delete&#39;, {id: produit.id}) }}&quot;
                                      class=&quot;d-inline&quot;
                                      onsubmit=&quot;return confirm(&#39;ÃŠtes-vous sÃ»r ?&#39;)&quot;&gt;
                                    &lt;input type=&quot;hidden&quot; name=&quot;_token&quot;
                                           value=&quot;{{ csrf_token(&#39;delete&#39; ~ produit.id) }}&quot;&gt;
                                    &lt;button type=&quot;submit&quot; class=&quot;btn btn-sm btn-danger&quot;&gt;
                                        &lt;i class=&quot;fas fa-trash&quot;&gt;&lt;/i&gt;
                                    &lt;/button&gt;
                                &lt;/form&gt;
                            &lt;/td&gt;
                        &lt;/tr&gt;
                    {% endfor %}
                &lt;/tbody&gt;
            &lt;/table&gt;
        &lt;/div&gt;
    &lt;/div&gt;
{% endblock %}</code></pre>
<p><strong>Points clÃ©s</strong> : - Badges colorÃ©s selon le niveau de
stock : - Rouge (<code>bg-danger</code>) si stock = 0 - Orange
(<code>bg-warning</code>) si stock &lt; 10 - Vert
(<code>bg-success</code>) si stock â‰¥ 10 - Token CSRF pour sÃ©curiser la
suppression - Confirmation JavaScript avant suppression</p>
<hr />
<h3 id="screenshots-pages-produits-panier-et-dashboard-admin">ğŸ“¸
Screenshots : Pages Produits, Panier et Dashboard Admin</h3>
<h4
id="screenshot-12-page-produits---liste-des-purificateurs">Screenshot 12
: Page Produits - Liste des Purificateurs</h4>
<p><strong>Vue de la page produits</strong> :</p>
<p><strong>Produits affichÃ©s (3 articles)</strong> :</p>
<ol type="1">
<li><strong>Moss Air 3</strong> (199,99â‚¬)
<ul>
<li>Badge : âœ… <strong>En stock (4 disponibles)</strong></li>
<li>Image du produit avec mousse vÃ©gÃ©tale</li>
<li>CaractÃ©ristiques listÃ©es :
<ul>
<li>Purificateur naturel des espaces intÃ©rieurs</li>
<li>Mousse vÃ©gÃ©tale vivante et auto-entretenue</li>
<li>Technologie de filtration Ã©cologique</li>
<li>Dimensions de 90% de CO2</li>
<li>Design innovant et design Ã©co-responsable</li>
<li>Entretien simplifiÃ©</li>
</ul></li>
<li>Input quantitÃ© avec sÃ©lecteur</li>
<li>Bouton vert <strong>â€œAjouter au panierâ€</strong></li>
</ul></li>
<li><strong>Moss Air 2</strong> (179,99â‚¬)
<ul>
<li>Badge : âœ… <strong>En stock (4 disponibles)</strong></li>
<li>Description similaire</li>
<li>CaractÃ©ristiques complÃ¨tes</li>
<li>Bouton <strong>â€œAjouter au panierâ€</strong></li>
</ul></li>
<li><strong>Moss Air 1</strong> (149,99â‚¬)
<ul>
<li>Badge : âœ… <strong>En stock (9 disponibles)</strong></li>
<li>Design fond noir</li>
<li>CaractÃ©ristiques dÃ©taillÃ©es</li>
<li>Bouton <strong>â€œAjouter au panierâ€</strong></li>
</ul></li>
</ol>
<p><strong>Points importants</strong> : - Les <strong>badges de
stock</strong> informent lâ€™utilisateur en temps rÃ©el de la disponibilitÃ©
- Si le stock Ã©tait Ã  0, le badge afficherait â€œRupture de stockâ€ en
rouge - Le formulaire dâ€™ajout au panier est intÃ©grÃ© directement dans
chaque carte produit</p>
<hr />
<h4 id="screenshot-13-panier-vide">Screenshot 13 : Panier Vide</h4>
<p><strong>Vue du panier sans article</strong> :</p>
<p><strong>Ã‰lÃ©ments affichÃ©s</strong> : - Titre : <strong>â€œMon
Panierâ€</strong> - Message : <em>â€œVotre panier est vide.â€</em> - Bouton
bleu : <strong>â€œContinuer mes achatsâ€</strong> â†’ Redirige vers
<code>/produit</code></p>
<p><strong>Code correspondant</strong> (dans
<code>panier/index.html.twig</code>) :</p>
<pre class="twig"><code>{% if panier is empty %}
    &lt;div class=&quot;alert alert-info text-center&quot;&gt;
        &lt;p&gt;Votre panier est vide.&lt;/p&gt;
        &lt;a href=&quot;{{ path(&#39;app_produit&#39;) }}&quot; class=&quot;btn btn-primary&quot;&gt;
            Continuer mes achats
        &lt;/a&gt;
    &lt;/div&gt;
{% endif %}</code></pre>
<p><strong>UX</strong> : Affichage clair pour inciter lâ€™utilisateur Ã 
dÃ©couvrir les produits</p>
<hr />
<h4
id="screenshot-14-panier-avec-produit---affichage-du-stock-restant">Screenshot
14 : Panier avec Produit - Affichage du Stock Restant</h4>
<p><strong>Vue du panier avec un article</strong> :</p>
<p><strong>Contenu du panier</strong> : - <strong>Produit</strong> :
Moss Air 3 - <strong>Prix unitaire</strong> : 199,99â‚¬ -
<strong>QuantitÃ©</strong> : 1 - <strong>Stock restant</strong> :
<strong>4</strong> â­ (affichÃ© en vert) - <strong>Prix total</strong> :
199,99â‚¬</p>
<p><strong>Actions disponibles</strong> : - Boutons <strong>+</strong>
et <strong>-</strong> pour modifier la quantitÃ© - Bouton rouge
<strong>poubelle</strong> pour retirer du panier - Bouton jaune
<strong>â€œVider le panierâ€</strong> (supprime tout) - Bouton vert
<strong>â€œPasser commandeâ€</strong> (lance le paiement) - Lien
<strong>â€œContinuer mes achatsâ€</strong> (retour aux produits)</p>
<p><strong>Information cruciale : Stock restant</strong></p>
<pre class="twig"><code>&lt;strong&gt;Stock restant:&lt;/strong&gt;
&lt;span class=&quot;stock-badge {% if item.stock &lt; 10 %}text-warning{% else %}text-success{% endif %}&quot;&gt;
    {{ item.stock }}
&lt;/span&gt;</code></pre>
<p><strong>Pourquoi câ€™est important ?</strong> - Lâ€™utilisateur voit
<strong>combien dâ€™unitÃ©s sont encore disponibles</strong> - Si le stock
est faible (&lt; 10), le badge devient orange pour alerter - EmpÃªche les
frustrations : lâ€™utilisateur sait sâ€™il peut commander plus</p>
<p><strong>VÃ©rification backend</strong> :</p>
<div class="sourceCode" id="cb32"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">// PanierController::ajouter()</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="va">$nouvelleQuantite</span> <span class="op">&gt;</span> <span class="va">$produit</span>-&gt;getStock()) {</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="va">$this</span>-&gt;addFlash(<span class="st">&#39;error&#39;</span><span class="ot">,</span> <span class="st">&quot;Stock insuffisant ! Seulement </span>{<span class="va">$produit</span>-&gt;getStock()}<span class="st"> disponible(s).&quot;</span>)<span class="ot">;</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">$this</span>-&gt;redirectToRoute(<span class="st">&#39;app_panier&#39;</span>)<span class="ot">;</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<hr />
<h4 id="screenshot-15-modal-de-confirmation-de-commande">Screenshot 15 :
Modal de Confirmation de Commande</h4>
<p><strong>Popup de validation avant paiement</strong> :</p>
<p><strong>Contenu du modal</strong> : - Titre : <strong>â€œConfirmer la
commandeâ€</strong> - Question : <em>â€œÃŠtes-vous sÃ»r de vouloir valider
cette commande ?â€</em> - Total affichÃ© : <strong>Total: 199,99â‚¬</strong>
- Bouton gris <strong>â€œAnnulerâ€</strong> (ferme le modal) - Bouton vert
<strong>â€œâœ“ Valider le paiementâ€</strong> (confirme et dÃ©crÃ©mente le
stock)</p>
<p><strong>Code JavaScript (dÃ©clenchement)</strong> :</p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;btnPasserCommande&#39;</span>)<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> <span class="kw">function</span>(e) {</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Afficher le modal Bootstrap</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> confirmModal <span class="op">=</span> <span class="kw">new</span> bootstrap<span class="op">.</span><span class="fu">Modal</span>(<span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;confirmModal&#39;</span>))<span class="op">;</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    confirmModal<span class="op">.</span><span class="fu">show</span>()<span class="op">;</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<p><strong>Action aprÃ¨s confirmation</strong> :</p>
<div class="sourceCode" id="cb34"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">// PanierController::paiementEffectue()</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="cf">foreach</span> (<span class="va">$panier</span> <span class="kw">as</span> <span class="va">$item</span>) {</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="va">$produit</span> <span class="op">=</span> <span class="va">$produitRepo</span>-&gt;find(<span class="va">$item</span>[<span class="st">&#39;product_id&#39;</span>])<span class="ot">;</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// DÃ©crÃ©menter le stock</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">$produit</span>-&gt;decrementStock(<span class="va">$item</span>[<span class="st">&#39;quantite&#39;</span>])<span class="ot">;</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// CrÃ©er la commande</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    <span class="va">$commande</span> <span class="op">=</span> <span class="kw">new</span> <span class="cn">C</span>ommande()<span class="ot">;</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    <span class="va">$commande</span>-&gt;setNomClient(<span class="va">$user</span>[<span class="st">&#39;prenom&#39;</span>])<span class="ot">;</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="va">$commande</span>-&gt;setProduit(<span class="va">$produit</span>-&gt;getNom())<span class="ot">;</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    <span class="va">$commande</span>-&gt;setQuantite(<span class="va">$item</span>[<span class="st">&#39;quantite&#39;</span>])<span class="ot">;</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ...</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    <span class="va">$entityManager</span>-&gt;persist(<span class="va">$commande</span>)<span class="ot">;</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="va">$entityManager</span>-&gt;<span class="fu">flush</span>()<span class="ot">;</span> <span class="co">// Sauvegarder tout</span></span></code></pre></div>
<p><strong>RÃ©sultat</strong> : Le stock est mis Ã  jour en base de
donnÃ©es et une entrÃ©e est crÃ©Ã©e dans la table <code>commande</code></p>
<hr />
<h4
id="screenshot-16-dashboard-admin---gestion-des-stocks-avec-badges-colorÃ©s">Screenshot
16 : Dashboard Admin - Gestion des Stocks avec Badges ColorÃ©s</h4>
<p><strong>Interface dâ€™administration</strong> :</p>
<p><strong>Header</strong> : - Titre : <strong>â€œDashboard
Adminâ€</strong> - Bouton cyan <strong>â€œğŸ‘¥ Utilisateursâ€</strong>
(gestion des utilisateurs) - Bouton bleu <strong>â€œ+ Nouveau
Produitâ€</strong> (crÃ©er un produit)</p>
<p><strong>Message de confirmation</strong> : - Alerte verte :
<strong>â€œProduit supprimÃ© avec succÃ¨s !â€</strong> (flash message)</p>
<p><strong>Tableau de gestion des produits</strong> :</p>
<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 8%" />
<col style="width: 9%" />
<col style="width: 11%" />
<col style="width: 13%" />
<col style="width: 24%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="header">
<th>ID</th>
<th>Image</th>
<th>Nom</th>
<th>Prix</th>
<th>Stock</th>
<th>Statut</th>
<th>Date crÃ©ation</th>
<th>Actions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>4</td>
<td>ğŸ–¼ï¸</td>
<td>Moss Air 1</td>
<td>149,99â‚¬</td>
<td><strong>9 (Faible)</strong> ğŸŸ¡</td>
<td>Actif âœ…</td>
<td>04/12/2025 11:40</td>
<td>âœï¸ ğŸ—‘ï¸</td>
</tr>
<tr class="even">
<td>5</td>
<td>ğŸ–¼ï¸</td>
<td>Moss Air 2</td>
<td>179,99â‚¬</td>
<td><strong>4 (Faible)</strong> ğŸŸ¡</td>
<td>Actif âœ…</td>
<td>04/12/2025 11:40</td>
<td>âœï¸ ğŸ—‘ï¸</td>
</tr>
<tr class="odd">
<td>6</td>
<td>ğŸ–¼ï¸</td>
<td>Moss Air 3</td>
<td>199,99â‚¬</td>
<td><strong>3 (Faible)</strong> ğŸŸ¡</td>
<td>Actif âœ…</td>
<td>04/12/2025 11:40</td>
<td>âœï¸ ğŸ—‘ï¸</td>
</tr>
</tbody>
</table>
<p><strong>SystÃ¨me de badges colorÃ©s</strong> :</p>
<ol type="1">
<li><p><strong>Badge jaune â€œ9 (Faible)â€</strong> :</p>
<pre class="twig"><code>{% if produit.stock &lt; 10 %}
    &lt;span class=&quot;badge bg-warning text-dark&quot;&gt;
        {{ produit.stock }} (Faible)
    &lt;/span&gt;
{% endif %}</code></pre>
<ul>
<li>Stock entre 1 et 9 â†’ Alerte orange/jaune</li>
<li>Lâ€™admin doit rÃ©approvisionner</li>
</ul></li>
<li><p><strong>Badge rouge â€œRuptureâ€</strong> (non visible ici mais dans
le code) :</p>
<pre class="twig"><code>{% if produit.stock == 0 %}
    &lt;span class=&quot;badge bg-danger&quot;&gt;Rupture&lt;/span&gt;
{% endif %}</code></pre>
<ul>
<li>Stock Ã  0 â†’ Rouge critique</li>
<li>Le produit ne peut plus Ãªtre commandÃ©</li>
</ul></li>
<li><p><strong>Badge vert (stock â‰¥ 10)</strong> :</p>
<pre class="twig"><code>{% else %}
    &lt;span class=&quot;badge bg-success&quot;&gt;{{ produit.stock }}&lt;/span&gt;
{% endif %}</code></pre>
<ul>
<li>Stock confortable â†’ Vert</li>
</ul></li>
</ol>
<p><strong>Actions disponibles</strong> : - <strong>Bouton jaune
(âœï¸)</strong> : Modifier le produit (nom, prix, <strong>stock</strong>,
image) - <strong>Bouton rouge (ğŸ—‘ï¸)</strong> : Supprimer le produit (avec
confirmation CSRF)</p>
<p><strong>Workflow admin pour gÃ©rer le stock</strong> : 1. Voir les
badges colorÃ©s pour identifier les produits Ã  faible stock 2. Cliquer
sur âœï¸ pour modifier 3. Augmenter la valeur du champ <code>stock</code>
4. Sauvegarder 5. Le badge passe de jaune Ã  vert si le stock dÃ©passe
10</p>
<p><strong>SÃ©curitÃ©</strong> : - AccÃ¨s restreint aux admins uniquement
via <code>checkAdmin()</code> - Tokens CSRF sur toutes les actions de
suppression - Confirmation JavaScript avant suppression</p>
<hr />
<h4
id="screenshot-17-modal-de-suppression-darticle-du-panier">Screenshot 17
: Modal de Suppression dâ€™Article du Panier</h4>
<p><strong>Confirmation JavaScript avant suppression</strong> :</p>
<p><strong>Contenu du modal</strong> : - URL :
<strong>127.0.0.1:8000</strong> (serveur de dÃ©veloppement Symfony) -
Titre : <em>â€œ127.0.0.1:8000 indiqueâ€</em> - Message : <strong>â€œSupprimer
Moss Air 3 du panier ?â€</strong> - Bouton bleu foncÃ©
<strong>â€œOKâ€</strong> (confirme la suppression) - Bouton bleu clair
<strong>â€œAnnulerâ€</strong> (annule lâ€™action)</p>
<p><strong>Code JavaScript correspondant</strong> :</p>
<div class="sourceCode" id="cb38"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Fonction de suppression avec confirmation</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="bu">document</span><span class="op">.</span><span class="fu">querySelectorAll</span>(<span class="st">&#39;.btn-supprimer-item&#39;</span>)<span class="op">.</span><span class="fu">forEach</span>(btn <span class="kw">=&gt;</span> {</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    btn<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> <span class="kw">function</span>(e) {</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>        e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> productName <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="fu">getAttribute</span>(<span class="st">&#39;data-product-name&#39;</span>)<span class="op">;</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Confirmation native du navigateur</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">confirm</span>(<span class="vs">`Supprimer </span><span class="sc">${</span>productName<span class="sc">}</span><span class="vs"> du panier ?`</span>)) {</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Si OK, soumettre le formulaire de suppression</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">closest</span>(<span class="st">&#39;form&#39;</span>)<span class="op">.</span><span class="fu">submit</span>()<span class="op">;</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<p><strong>Route backend</strong> :</p>
<div class="sourceCode" id="cb39"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span><span class="cn">R</span>oute(<span class="st">&#39;/panier/retirer/{product_id}&#39;</span><span class="ot">,</span> name<span class="ot">:</span> <span class="st">&#39;app_panier_retirer&#39;</span><span class="ot">,</span> methods<span class="ot">:</span> [<span class="st">&#39;POST&#39;</span>])<span class="at">]</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">function</span> retirer(<span class="dt">int</span> <span class="va">$product_id</span><span class="ot">,</span> <span class="cn">S</span>essionInterface <span class="va">$session</span>)<span class="ot">:</span> <span class="cn">R</span>esponse</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="va">$panier</span> <span class="op">=</span> <span class="va">$session</span>-&gt;get(<span class="st">&#39;panier&#39;</span><span class="ot">,</span> [])<span class="ot">;</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Retirer le produit du panier</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="va">$panier</span> <span class="op">=</span> <span class="fu">array_filter</span>(<span class="va">$panier</span><span class="ot">,</span> <span class="kw">function</span>(<span class="va">$item</span>) <span class="kw">use</span> (<span class="va">$product_id</span>) {</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">$item</span>[<span class="st">&#39;product_id&#39;</span>] <span class="op">!==</span> <span class="va">$product_id</span><span class="ot">;</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    })<span class="ot">;</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// RÃ©indexer le tableau</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    <span class="va">$panier</span> <span class="op">=</span> <span class="fu">array_values</span>(<span class="va">$panier</span>)<span class="ot">;</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Mettre Ã  jour la session</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    <span class="va">$session</span>-&gt;set(<span class="st">&#39;panier&#39;</span><span class="ot">,</span> <span class="va">$panier</span>)<span class="ot">;</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>    <span class="va">$this</span>-&gt;addFlash(<span class="st">&#39;success&#39;</span><span class="ot">,</span> <span class="st">&#39;Produit retirÃ© du panier&#39;</span>)<span class="ot">;</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">$this</span>-&gt;redirectToRoute(<span class="st">&#39;app_panier&#39;</span>)<span class="ot">;</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>UX</strong> : EmpÃªche les suppressions accidentelles avec une
confirmation claire</p>
<hr />
<h4
id="screenshot-18-page-dÃ©tail-produit-avec-message-de-succÃ¨s">Screenshot
18 : Page DÃ©tail Produit avec Message de SuccÃ¨s</h4>
<p><strong>Vue dÃ©taillÃ©e dâ€™un produit aprÃ¨s ajout au panier</strong>
:</p>
<p><strong>Message de confirmation</strong> : - Alerte verte en haut :
<strong>â€œMoss Air 3 ajoutÃ© au panier !â€</strong> (flash message) -
Affichage temporaire (disparaÃ®t aprÃ¨s quelques secondes)</p>
<p><strong>Informations produit</strong> : - Grande image : Moss Air 3
(fond noir) - Nom : <strong>Moss Air 3</strong> - Prix :
<strong>199,99â‚¬</strong> - Badge vert : <strong>âœ“ En stock (3
disponible(s))</strong> - Description : <em>â€œPurificateur dâ€™air haut de
gamme avec technologie avancÃ©e de mousse stabilisÃ©e. Le meilleur de
notre gamme.â€</em> - Input <strong>â€œQuantitÃ© :â€</strong> avec sÃ©lecteur
- Bouton vert : <strong>â€œAjouter au panierâ€</strong></p>
<p><strong>CaractÃ©ristiques listÃ©es</strong> : - âœ“ Filtration naturelle
par mousse vivante - âœ“ RÃ©duction de 90% des particules fines - âœ“
Diminution de 60% des COV - âœ“ RÃ©duction de 40% du CO2 - âœ“ Design
minimaliste et Ã©lÃ©gant - âœ“ Entretien minimal</p>
<p><strong>Code Twig pour le message</strong> :</p>
<pre class="twig"><code>{% for message in app.flashes(&#39;success&#39;) %}
    &lt;div class=&quot;alert alert-success alert-dismissible fade show&quot; role=&quot;alert&quot;&gt;
        {{ message }}
        &lt;button type=&quot;button&quot; class=&quot;btn-close&quot; data-bs-dismiss=&quot;alert&quot;&gt;&lt;/button&gt;
    &lt;/div&gt;
{% endfor %}</code></pre>
<p><strong>Code PHP (ajout au panier)</strong> :</p>
<div class="sourceCode" id="cb41"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="va">$this</span>-&gt;addFlash(<span class="st">&#39;success&#39;</span><span class="ot">,</span> <span class="st">&quot;</span>{<span class="va">$produit</span>-&gt;getNom()}<span class="st"> ajoutÃ© au panier !&quot;</span>)<span class="ot">;</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="cf">return</span> <span class="va">$this</span>-&gt;redirectToRoute(<span class="st">&#39;app_produit_show&#39;</span><span class="ot">,</span> [<span class="st">&#39;id&#39;</span> =&gt; <span class="va">$produit</span>-&gt;getId()])<span class="ot">;</span></span></code></pre></div>
<p><strong>Badge de stock dynamique</strong> : - <strong>3
disponible(s)</strong> â†’ Stock faible affichÃ© en vert avec âœ“ - Si stock
= 0 â†’ Badge rouge â€œRupture de stockâ€ + bouton dÃ©sactivÃ©</p>
<hr />
<h4
id="screenshot-19-page-produits---version-mobile-responsive-1">Screenshot
19 : Page Produits - Version Mobile Responsive (1)</h4>
<p><strong>Vue mobile de la page produits</strong> :</p>
<p><strong>Header mobile</strong> : - Logo <strong>â€œMossAirâ€</strong>
avec menu hamburger (â˜°)</p>
<p><strong>Produits affichÃ©s verticalement</strong> :</p>
<ol type="1">
<li><strong>Moss Air 3</strong> (199,99â‚¬)
<ul>
<li>Image pleine largeur</li>
<li>Badge vert : <strong>âœ“ En stock (3 disponible(s))</strong></li>
<li>Description courte</li>
<li><strong>QuantitÃ© :</strong> input avec valeur par dÃ©faut 1</li>
<li>Bouton vert : <strong>â€œAjouter au panierâ€</strong> (pleine
largeur)</li>
<li><strong>CaractÃ©ristiques :</strong> liste complÃ¨te (6 points)</li>
</ul></li>
<li><strong>Moss Air 2</strong> (179,99â‚¬)
<ul>
<li>Image pleine largeur (fond blanc avec bureau)</li>
<li>Badge vert : <strong>âœ“ En stock (4 disponible(s))</strong></li>
<li>Description</li>
<li>Input quantitÃ©</li>
<li>Bouton <strong>â€œAjouter au panierâ€</strong></li>
<li><strong>CaractÃ©ristiques :</strong> liste commencÃ©e (3 points
visibles)</li>
</ul></li>
</ol>
<p><strong>Adaptations responsive</strong> : - Layout vertical (1
colonne) au lieu de grille - Images 100% de largeur - Boutons Ã©tendus
sur toute la largeur - Espacement augmentÃ© pour faciliter le tactile -
Texte et badges lisibles sur petit Ã©cran</p>
<p><strong>Media query correspondante</strong> :</p>
<div class="sourceCode" id="cb42"><pre
class="sourceCode css"><code class="sourceCode css"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">@media</span> (<span class="kw">max-width</span>: <span class="dv">768</span><span class="dt">px</span>) {</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">.product-grid</span> {</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">grid-template-columns</span>: <span class="dv">1</span><span class="dt">fr</span><span class="op">;</span> <span class="co">/* 1 colonne au lieu de 3 */</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">.product-card</span> {</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">width</span>: <span class="dv">100</span><span class="dt">%</span><span class="op">;</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">margin-bottom</span>: <span class="dv">2</span><span class="dt">rem</span><span class="op">;</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">.btn-add-to-cart</span> {</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">width</span>: <span class="dv">100</span><span class="dt">%</span><span class="op">;</span> <span class="co">/* Bouton pleine largeur */</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">padding</span>: <span class="dv">15</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">font-size</span>: <span class="dv">16</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<hr />
<h4
id="screenshot-20-page-produits---version-mobile-responsive-2">Screenshot
20 : Page Produits - Version Mobile Responsive (2)</h4>
<p><strong>Vue mobile alternative</strong> - MÃªme structure mais scroll
diffÃ©rent :</p>
<p><strong>Produits visibles</strong> : 1. <strong>Moss Air 3</strong>
(bas de la carte) - CaractÃ©ristiques listÃ©es - QuantitÃ© + bouton
dâ€™ajout</p>
<ol start="2" type="1">
<li><strong>Moss Air 2</strong> (carte complÃ¨te visible)
<ul>
<li>Image du produit</li>
<li>Prix : <strong>179,99â‚¬</strong></li>
<li>Badge : <strong>âœ“ En stock (4 disponible(s))</strong></li>
<li>Description complÃ¨te</li>
<li>Liste des caractÃ©ristiques :
<ul>
<li>âœ“ Filtration naturelle par mousse vivante</li>
<li>âœ“ RÃ©duction de 90% des particules fines</li>
<li>âœ“ Diminution de 60% des COV</li>
</ul></li>
</ul></li>
</ol>
<p><strong>Points clÃ©s de la version mobile</strong> : - Navigation par
scroll vertical fluide - Toutes les informations restent accessibles -
Pas de perte de fonctionnalitÃ© vs desktop - Touch-friendly (zones de
clic larges) - Badges de stock bien visibles</p>
<p><strong>Test de responsive</strong> :</p>
<div class="sourceCode" id="cb43"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">// DÃ©tection de l&#39;Ã©cran mobile</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="bu">window</span><span class="op">.</span><span class="at">innerWidth</span> <span class="op">&lt;=</span> <span class="dv">768</span>) {</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Adapter les interactions tactiles</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">document</span><span class="op">.</span><span class="fu">querySelectorAll</span>(<span class="st">&#39;.btn-add-to-cart&#39;</span>)<span class="op">.</span><span class="fu">forEach</span>(btn <span class="kw">=&gt;</span> {</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>        btn<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">minHeight</span> <span class="op">=</span> <span class="st">&#39;48px&#39;</span><span class="op">;</span> <span class="co">// Taille minimale pour tactile</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<hr />
<h2 id="base-de-donnÃ©es-structure-et-relations">17. Base de DonnÃ©es :
Structure et Relations</h2>
<h3 id="modÃ¨le-logique-de-donnÃ©es-mld">ModÃ¨le Logique de DonnÃ©es
(MLD)</h3>
<p><strong>Base de donnÃ©es</strong> : <code>projet_moss</code></p>
<h4 id="table-user">Table <code>user</code></h4>
<div class="sourceCode" id="cb44"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> <span class="fu">user</span> (</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">id</span> <span class="dt">INT</span> AUTO_INCREMENT <span class="kw">PRIMARY</span> <span class="kw">KEY</span>,</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    prenom <span class="dt">VARCHAR</span>(<span class="dv">100</span>) <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    nom <span class="dt">VARCHAR</span>(<span class="dv">100</span>) <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    email <span class="dt">VARCHAR</span>(<span class="dv">255</span>) <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">UNIQUE</span>,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">password</span> <span class="dt">VARCHAR</span>(<span class="dv">255</span>) <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">role</span> ENUM(<span class="st">&#39;user&#39;</span>, <span class="st">&#39;admin&#39;</span>) <span class="kw">DEFAULT</span> <span class="st">&#39;user&#39;</span>,</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    created_at DATETIME <span class="kw">DEFAULT</span> <span class="fu">CURRENT_TIMESTAMP</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>);</span></code></pre></div>
<p><strong>Champs</strong> : - <code>id</code> : Identifiant unique
auto-incrÃ©mentÃ© - <code>prenom</code> et <code>nom</code> : Nom complet
de lâ€™utilisateur - <code>email</code> : Email unique (utilisÃ© pour la
connexion) - <code>password</code> : Mot de passe hachÃ© avec
<code>password_hash()</code> - <code>role</code> : RÃ´le de lâ€™utilisateur
(â€˜userâ€™ ou â€˜adminâ€™) - <code>created_at</code> : Date de crÃ©ation du
compte</p>
<h4 id="table-produit">Table <code>produit</code></h4>
<div class="sourceCode" id="cb45"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> produit (</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">id</span> <span class="dt">INT</span> AUTO_INCREMENT <span class="kw">PRIMARY</span> <span class="kw">KEY</span>,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    nom <span class="dt">VARCHAR</span>(<span class="dv">255</span>) <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    description LONGTEXT,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    prix <span class="dt">DOUBLE</span> <span class="dt">PRECISION</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    image <span class="dt">VARCHAR</span>(<span class="dv">255</span>),</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    actif TINYINT(<span class="dv">1</span>) <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">DEFAULT</span> <span class="dv">1</span>,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    stock <span class="dt">INT</span> <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">DEFAULT</span> <span class="dv">0</span>,  <span class="co">-- COLONNE STOCK</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    created_at DATETIME <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    updated_at DATETIME <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>);</span></code></pre></div>
<p><strong>Champs</strong> : - <code>id</code> : Identifiant unique du
produit - <code>nom</code> : Nom du produit - <code>description</code> :
Description dÃ©taillÃ©e (texte long) - <code>prix</code> : Prix en euros
(dÃ©cimal) - <code>image</code> : Nom du fichier image -
<code>actif</code> : Produit actif (1) ou inactif (0) -
<strong><code>stock</code></strong> : QuantitÃ© disponible en stock
(nombre entier) - <code>created_at</code> : Date de crÃ©ation -
<code>updated_at</code> : Date de derniÃ¨re modification</p>
<h4 id="table-commande">Table <code>commande</code></h4>
<div class="sourceCode" id="cb46"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> commande (</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">id</span> <span class="dt">INT</span> AUTO_INCREMENT <span class="kw">PRIMARY</span> <span class="kw">KEY</span>,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    nom_client <span class="dt">VARCHAR</span>(<span class="dv">255</span>) <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    produit <span class="dt">VARCHAR</span>(<span class="dv">255</span>) <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    quantite <span class="dt">INT</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    prix <span class="dt">DOUBLE</span> <span class="dt">PRECISION</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    image <span class="dt">VARCHAR</span>(<span class="dv">255</span>),</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>    date_commande DATETIME <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>    created_at DATETIME <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>);</span></code></pre></div>
<p><strong>Champs</strong> : - <code>id</code> : Identifiant unique de
la commande - <code>nom_client</code> : Nom de lâ€™utilisateur qui a passÃ©
la commande - <code>produit</code> : Nom du produit commandÃ© -
<code>quantite</code> : QuantitÃ© commandÃ©e - <code>prix</code> : Prix
unitaire au moment de la commande - <code>date_commande</code> : Date et
heure de la commande - <code>created_at</code> : Date de crÃ©ation de
lâ€™enregistrement</p>
<hr />
<h3 id="screenshots-structure-rÃ©elle-des-tables-phpmyadmin">ğŸ“¸
Screenshots : Structure RÃ©elle des Tables (phpMyAdmin)</h3>
<h4 id="screenshot-1-structure-de-la-table-user">Screenshot 1 :
Structure de la table <code>user</code></h4>
<p><strong>Vue dans phpMyAdmin</strong> - Voici la structure rÃ©elle de
la table user telle quâ€™elle existe en base de donnÃ©es :</p>
<table>
<colgroup>
<col style="width: 5%" />
<col style="width: 8%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 31%" />
<col style="width: 11%" />
<col style="width: 23%" />
</colgroup>
<thead>
<tr class="header">
<th>#</th>
<th>Nom</th>
<th>Type</th>
<th>Null</th>
<th>Valeur par dÃ©faut</th>
<th>Extra</th>
<th>Commentaires</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td><strong>id</strong></td>
<td>int</td>
<td>Non</td>
<td>Aucun(e)</td>
<td>AUTO_INCREMENT</td>
<td>Identifiant unique</td>
</tr>
<tr class="even">
<td>2</td>
<td><strong>email</strong></td>
<td>varchar(255)</td>
<td>Non</td>
<td>Aucun(e)</td>
<td></td>
<td>Email de connexion</td>
</tr>
<tr class="odd">
<td>3</td>
<td><strong>password</strong></td>
<td>varchar(255)</td>
<td>Non</td>
<td>Aucun(e)</td>
<td></td>
<td>Mot de passe hachÃ©</td>
</tr>
<tr class="even">
<td>4</td>
<td><strong>nom</strong></td>
<td>varchar(255)</td>
<td>Non</td>
<td>Aucun(e)</td>
<td></td>
<td>Nom de famille</td>
</tr>
<tr class="odd">
<td>5</td>
<td><strong>prenom</strong></td>
<td>varchar(255)</td>
<td>Non</td>
<td>Aucun(e)</td>
<td></td>
<td>PrÃ©nom</td>
</tr>
<tr class="even">
<td>6</td>
<td><strong>photo</strong></td>
<td>varchar(255)</td>
<td>Oui</td>
<td>NULL</td>
<td></td>
<td>Photo de profil</td>
</tr>
<tr class="odd">
<td>7</td>
<td><strong>created_at</strong></td>
<td>datetime</td>
<td>Non</td>
<td>Aucun(e)</td>
<td>(DC2Type:datetime_immutable)</td>
<td>Date de crÃ©ation</td>
</tr>
<tr class="even">
<td>8</td>
<td><strong>updated_at</strong></td>
<td>datetime</td>
<td>Non</td>
<td>Aucun(e)</td>
<td>(DC2Type:datetime_immutable)</td>
<td>Date de modification</td>
</tr>
<tr class="odd">
<td>9</td>
<td><strong>actif</strong></td>
<td>tinyint(1)</td>
<td>Non</td>
<td>Aucun(e)</td>
<td></td>
<td>Compte actif ou non</td>
</tr>
<tr class="even">
<td>10</td>
<td><strong>role</strong></td>
<td>varchar(50)</td>
<td>Oui</td>
<td>user</td>
<td></td>
<td>RÃ´le (user/admin)</td>
</tr>
</tbody>
</table>
<p><strong>ClÃ© primaire</strong> : id (PRIMARY - BTREE)</p>
<p><strong>Points importants</strong> : - Le champ <code>role</code> a
une valeur par dÃ©faut Ã  <strong>â€œuserâ€</strong> - Les mots de passe sont
stockÃ©s en <code>varchar(255)</code> pour supporter le hachage bcrypt -
Les dates utilisent le type Doctrine <code>datetime_immutable</code>
pour Ã©viter les modifications accidentelles</p>
<h4 id="screenshot-2-structure-de-la-table-produit">Screenshot 2 :
Structure de la table <code>produit</code></h4>
<p><strong>Vue dans phpMyAdmin</strong> - Voici la structure rÃ©elle de
la table produit avec le champ stock :</p>
<table>
<colgroup>
<col style="width: 5%" />
<col style="width: 8%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 31%" />
<col style="width: 11%" />
<col style="width: 23%" />
</colgroup>
<thead>
<tr class="header">
<th>#</th>
<th>Nom</th>
<th>Type</th>
<th>Null</th>
<th>Valeur par dÃ©faut</th>
<th>Extra</th>
<th>Commentaires</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td><strong>id</strong></td>
<td>int</td>
<td>Non</td>
<td>Aucun(e)</td>
<td>AUTO_INCREMENT</td>
<td>Identifiant unique</td>
</tr>
<tr class="even">
<td>2</td>
<td><strong>nom</strong></td>
<td>varchar(255)</td>
<td>Non</td>
<td>Aucun(e)</td>
<td></td>
<td>Nom du produit</td>
</tr>
<tr class="odd">
<td>3</td>
<td><strong>description</strong></td>
<td>longtext</td>
<td>Oui</td>
<td>NULL</td>
<td></td>
<td>Description dÃ©taillÃ©e</td>
</tr>
<tr class="even">
<td>4</td>
<td><strong>prix</strong></td>
<td>double</td>
<td>Non</td>
<td>Aucun(e)</td>
<td></td>
<td>Prix en euros</td>
</tr>
<tr class="odd">
<td>5</td>
<td><strong>image</strong></td>
<td>varchar(255)</td>
<td>Oui</td>
<td>NULL</td>
<td></td>
<td>Nom du fichier image</td>
</tr>
<tr class="even">
<td>6</td>
<td><strong>actif</strong></td>
<td>tinyint(1)</td>
<td>Non</td>
<td>Aucun(e)</td>
<td></td>
<td>Produit actif/inactif</td>
</tr>
<tr class="odd">
<td>7</td>
<td><strong>created_at</strong></td>
<td>datetime</td>
<td>Non</td>
<td>Aucun(e)</td>
<td>(DC2Type:datetime_immutable)</td>
<td>Date de crÃ©ation</td>
</tr>
<tr class="even">
<td>8</td>
<td><strong>updated_at</strong></td>
<td>datetime</td>
<td>Non</td>
<td>Aucun(e)</td>
<td>(DC2Type:datetime_immutable)</td>
<td>Date de modification</td>
</tr>
<tr class="odd">
<td>9</td>
<td><strong>stock</strong> â­</td>
<td>int</td>
<td>Oui</td>
<td><strong>0</strong></td>
<td></td>
<td><strong>QuantitÃ© en stock</strong></td>
</tr>
</tbody>
</table>
<p><strong>ClÃ© primaire</strong> : id (PRIMARY - BTREE)</p>
<p><strong>Points importants</strong> : - La colonne
<strong><code>stock</code></strong> (ligne 9) a Ã©tÃ© ajoutÃ©e via la
migration <code>Version20251203150000</code> - Valeur par dÃ©faut :
<strong>0</strong> (pas de stock par dÃ©faut) - Type <code>int</code>
pour stocker des nombres entiers uniquement - Accepte NULL mais avec
dÃ©faut 0 pour Ã©viter les valeurs nulles</p>
<p><strong>Cette colonne est cruciale pour</strong> : - VÃ©rifier la
disponibilitÃ© avant ajout au panier - EmpÃªcher les surventes -
DÃ©crÃ©menter automatiquement aprÃ¨s une commande - Afficher des badges
colorÃ©s dans le dashboard admin</p>
<h4 id="screenshot-3-structure-de-la-table-commande">Screenshot 3 :
Structure de la table <code>commande</code></h4>
<p><strong>Vue dans phpMyAdmin</strong> - Voici la structure rÃ©elle de
la table commande :</p>
<table>
<colgroup>
<col style="width: 5%" />
<col style="width: 8%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 31%" />
<col style="width: 11%" />
<col style="width: 23%" />
</colgroup>
<thead>
<tr class="header">
<th>#</th>
<th>Nom</th>
<th>Type</th>
<th>Null</th>
<th>Valeur par dÃ©faut</th>
<th>Extra</th>
<th>Commentaires</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td><strong>id</strong></td>
<td>int</td>
<td>Non</td>
<td>Aucun(e)</td>
<td>AUTO_INCREMENT</td>
<td>Identifiant unique</td>
</tr>
<tr class="even">
<td>2</td>
<td><strong>nom_client</strong></td>
<td>varchar(255)</td>
<td>Non</td>
<td>Aucun(e)</td>
<td></td>
<td>Nom du client</td>
</tr>
<tr class="odd">
<td>3</td>
<td><strong>produit</strong></td>
<td>varchar(255)</td>
<td>Non</td>
<td>Aucun(e)</td>
<td></td>
<td>Nom du produit commandÃ©</td>
</tr>
<tr class="even">
<td>4</td>
<td><strong>quantite</strong></td>
<td>int</td>
<td>Non</td>
<td>Aucun(e)</td>
<td></td>
<td>QuantitÃ© commandÃ©e</td>
</tr>
<tr class="odd">
<td>5</td>
<td><strong>date_commande</strong></td>
<td>datetime</td>
<td>Non</td>
<td>Aucun(e)</td>
<td></td>
<td>Date et heure de la commande</td>
</tr>
<tr class="even">
<td>6</td>
<td><strong>couleur</strong></td>
<td>varchar(255)</td>
<td>Oui</td>
<td>NULL</td>
<td></td>
<td>Couleur du produit (optionnel)</td>
</tr>
<tr class="odd">
<td>7</td>
<td><strong>prix</strong></td>
<td>decimal(10,2)</td>
<td>Oui</td>
<td>NULL</td>
<td></td>
<td>Prix unitaire au moment de la commande</td>
</tr>
<tr class="even">
<td>8</td>
<td><strong>created_at</strong></td>
<td>datetime</td>
<td>Oui</td>
<td>NULL</td>
<td>(DC2Type:datetime_immutable)</td>
<td>Date de crÃ©ation</td>
</tr>
<tr class="odd">
<td>9</td>
<td><strong>image</strong></td>
<td>varchar(255)</td>
<td>Oui</td>
<td>NULL</td>
<td></td>
<td>Image du produit commandÃ©</td>
</tr>
</tbody>
</table>
<p><strong>ClÃ© primaire</strong> : id (PRIMARY - BTREE)</p>
<p><strong>Points importants</strong> : - Cette table stocke
lâ€™historique de toutes les commandes passÃ©es - Le champ
<code>nom_client</code> correspond au prÃ©nom de lâ€™utilisateur - Le champ
<code>quantite</code> indique combien dâ€™unitÃ©s ont Ã©tÃ© commandÃ©es - Le
prix est stockÃ© en <code>decimal(10,2)</code> pour Ã©viter les erreurs
dâ€™arrondi</p>
<hr />
<h3 id="screenshots-donnÃ©es-rÃ©elles-dans-les-tables-phpmyadmin">ğŸ“¸
Screenshots : DonnÃ©es RÃ©elles dans les Tables (phpMyAdmin)</h3>
<h4 id="screenshot-4-donnÃ©es-dans-la-table-produit">Screenshot 4 :
DonnÃ©es dans la table <code>produit</code></h4>
<p><strong>Exemples de produits avec leurs stocks</strong> :</p>
<table>
<colgroup>
<col style="width: 5%" />
<col style="width: 6%" />
<col style="width: 17%" />
<col style="width: 7%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 13%" />
</colgroup>
<thead>
<tr class="header">
<th>id</th>
<th>nom</th>
<th>description</th>
<th>prix</th>
<th>image</th>
<th>actif</th>
<th>created_at</th>
<th>updated_at</th>
<th>stock â­</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>gsqlkn</td>
<td>gsmai</td>
<td>25.00</td>
<td>Capture-d-ecran-2025-09-23â€¦</td>
<td>1</td>
<td>2025-10-28 11:23:06</td>
<td>2025-12-04 10:28:32</td>
<td><strong>9</strong></td>
</tr>
<tr class="even">
<td>3</td>
<td>sedf</td>
<td>sdf</td>
<td>251.00</td>
<td>videoframe-6368-693045935c408.png</td>
<td>1</td>
<td>2025-12-03 14:13:39</td>
<td>2025-12-04 10:28:32</td>
<td><strong>9</strong></td>
</tr>
<tr class="odd">
<td>4</td>
<td>Moss Air 1</td>
<td>Purificateur dâ€™air naturel avec mousse vÃ©gÃ©tale. Dâ€¦</td>
<td>149.99</td>
<td>hero1.jpg</td>
<td>1</td>
<td>2025-12-04 11:40:06</td>
<td>2025-12-04 10:55:45</td>
<td><strong>9</strong></td>
</tr>
<tr class="even">
<td>5</td>
<td>Moss Air 2</td>
<td>Purificateur dâ€™air premium avec double filtration â€¦</td>
<td>179.99</td>
<td>hero2.jpg</td>
<td>1</td>
<td>2025-12-04 11:40:08</td>
<td>2025-12-04 10:55:45</td>
<td><strong>4</strong></td>
</tr>
<tr class="odd">
<td>6</td>
<td>Moss Air 3</td>
<td>Purificateur dâ€™air haut de gamme avec technologie â€¦</td>
<td>199.99</td>
<td>hero3.jpg</td>
<td>1</td>
<td>2025-12-04 11:40:25</td>
<td>2025-12-04 10:55:45</td>
<td><strong>4</strong></td>
</tr>
</tbody>
</table>
<p><strong>Observations</strong> : - Les produits <strong>Moss Air
1</strong> ont un stock confortable de <strong>9 unitÃ©s</strong> (badge
vert dans le dashboard) - Les produits <strong>Moss Air 2</strong> et
<strong>Moss Air 3</strong> ont un stock <strong>faible de 4
unitÃ©s</strong> (badge orange dans le dashboard) - Tous les produits
sont actifs (<code>actif = 1</code>) - Les dates <code>updated_at</code>
montrent les derniÃ¨res modifications de stock aprÃ¨s les commandes</p>
<h4 id="screenshot-5-donnÃ©es-dans-la-table-user">Screenshot 5 : DonnÃ©es
dans la table <code>user</code></h4>
<p><strong>Exemples dâ€™utilisateurs avec leurs rÃ´les</strong> :</p>
<table>
<colgroup>
<col style="width: 5%" />
<col style="width: 8%" />
<col style="width: 12%" />
<col style="width: 6%" />
<col style="width: 10%" />
<col style="width: 8%" />
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 8%" />
<col style="width: 7%" />
</colgroup>
<thead>
<tr class="header">
<th>id</th>
<th>email</th>
<th>password</th>
<th>nom</th>
<th>prenom</th>
<th>photo</th>
<th>created_at</th>
<th>updated_at</th>
<th>actif</th>
<th>role</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>arnaudbarotteaux@gmail.com</td>
<td>$2y<span
class="math inline">10</span>peHolbQPH71hqmdDGRKZ.3JJZ0OuboTN31pFqR53cnâ€¦</td>
<td>arnaud</td>
<td>NULL</td>
<td>NULL</td>
<td>2025-10-28 12:07:11</td>
<td>0000-00-00 00:00:00</td>
<td>0</td>
<td><strong>admin</strong></td>
</tr>
<tr class="even">
<td>5</td>
<td>user@gmail.com</td>
<td>$2y<span
class="math inline">10</span>I39j8a2SS0eX8oNB5KYk4.CxEmTtrpjeC0nadEHMNglâ€¦</td>
<td>user</td>
<td>user</td>
<td>NULL</td>
<td>2025-12-03 16:04:18</td>
<td>0000-00-00 00:00:00</td>
<td>0</td>
<td><strong>user</strong></td>
</tr>
</tbody>
</table>
<p><strong>Observations</strong> : - <strong>Utilisateur 1</strong>
(arnaudbarotteaux@gmail.com) a le rÃ´le <strong>â€œadminâ€</strong> â†’ AccÃ¨s
au dashboard admin - <strong>Utilisateur 5</strong> (user@gmail.com) a
le rÃ´le <strong>â€œuserâ€</strong> â†’ Utilisateur normal sans accÃ¨s admin -
Les mots de passe sont <strong>hachÃ©s avec bcrypt</strong>
(<code>$2y$10$...</code>) pour la sÃ©curitÃ© - Le champ <code>actif</code>
est Ã  0 pour les deux (dÃ©sactivÃ© temporairement)</p>
<p><strong>DiffÃ©rence entre les rÃ´les</strong> : -
<strong>admin</strong> : Peut accÃ©der Ã  <code>/admin</code>, gÃ©rer les
produits, modifier les stocks, gÃ©rer les utilisateurs -
<strong>user</strong> : Peut naviguer sur le site, ajouter au panier,
passer des commandes</p>
<h4 id="screenshot-6-donnÃ©es-dans-la-table-commande">Screenshot 6 :
DonnÃ©es dans la table <code>commande</code></h4>
<p><strong>Exemples de commandes passÃ©es</strong> :</p>
<table style="width:100%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 14%" />
<col style="width: 10%" />
<col style="width: 11%" />
<col style="width: 17%" />
<col style="width: 10%" />
<col style="width: 7%" />
<col style="width: 14%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="header">
<th>id</th>
<th>nom_client</th>
<th>produit</th>
<th>quantite</th>
<th>date_commande</th>
<th>couleur</th>
<th>prix</th>
<th>created_at</th>
<th>image</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>18</td>
<td>user</td>
<td>Moss Air 3</td>
<td>4</td>
<td>2025-12-04 10:55:45</td>
<td>NULL</td>
<td>199.99</td>
<td>2025-12-04 10:55:45</td>
<td>hero3.jpg</td>
</tr>
<tr class="even">
<td>19</td>
<td>user</td>
<td>Moss Air 2</td>
<td>4</td>
<td>2025-12-04 10:55:45</td>
<td>NULL</td>
<td>179.99</td>
<td>2025-12-04 10:55:45</td>
<td>hero2.jpg</td>
</tr>
<tr class="odd">
<td>20</td>
<td>user</td>
<td>Moss Air 1</td>
<td>3</td>
<td>2025-12-04 10:55:45</td>
<td>NULL</td>
<td>149.99</td>
<td>2025-12-04 10:55:45</td>
<td>hero1.jpg</td>
</tr>
</tbody>
</table>
<p><strong>Observations</strong> : - Lâ€™utilisateur
<strong>â€œuserâ€</strong> a passÃ© <strong>3 commandes</strong> le 4
dÃ©cembre 2025 Ã  10h55 - <strong>Commande 18</strong> : 4 unitÃ©s de Moss
Air 3 â†’ Le stock du produit est passÃ© de 8 Ã  4 - <strong>Commande
19</strong> : 4 unitÃ©s de Moss Air 2 â†’ Le stock du produit est passÃ© de
8 Ã  4 - <strong>Commande 20</strong> : 3 unitÃ©s de Moss Air 1 â†’ Le stock
du produit est passÃ© de 12 Ã  9 - Les prix sont enregistrÃ©s au moment de
la commande pour garder lâ€™historique exact</p>
<p><strong>Lien avec le systÃ¨me de stock</strong> : - Quand une commande
est validÃ©e via <code>PanierController::paiementEffectue()</code> - Le
systÃ¨me dÃ©crÃ©mente automatiquement le stock avec
<code>$produit-&gt;decrementStock($quantite)</code> - Une entrÃ©e est
crÃ©Ã©e dans la table <code>commande</code> pour lâ€™historique</p>
<hr />
<h3 id="modÃ¨le-conceptuel-de-donnÃ©es-mcd">ModÃ¨le Conceptuel de DonnÃ©es
(MCD)</h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      USER       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚
â”‚ prenom          â”‚
â”‚ nom             â”‚
â”‚ email           â”‚
â”‚ password        â”‚
â”‚ role            â”‚
â”‚ created_at      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ 1:N
        â”‚ passe
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   COMMANDE      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚
â”‚ nom_client      â”‚
â”‚ produit         â”‚
â”‚ quantite        â”‚
â”‚ prix            â”‚
â”‚ date_commande   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ N:1
        â”‚ contient
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    PRODUIT      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚
â”‚ nom             â”‚
â”‚ description     â”‚
â”‚ prix            â”‚
â”‚ image           â”‚
â”‚ actif           â”‚
â”‚ stock           â”‚â—„â”€â”€ NOUVEAU CHAMP
â”‚ created_at      â”‚
â”‚ updated_at      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
<p><strong>Relations</strong> : - <strong>USER â†’ COMMANDE</strong> : Un
utilisateur peut passer plusieurs commandes (1:N) - <strong>COMMANDE â†’
PRODUIT</strong> : Une commande contient un ou plusieurs produits
(N:1)</p>
<hr />
<h2 id="flux-de-gestion-du-stock">18. Flux de Gestion du Stock</h2>
<h3 id="diagramme-du-flux">Diagramme du Flux</h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  AJOUT AU PANIER                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Formulaire produit (product_id)     â”‚
        â”‚  Input quantitÃ©                      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼ POST /panier/ajouter
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  PanierController::ajouter()         â”‚
        â”‚  1. RÃ©cupÃ©rer product_id &amp; quantite  â”‚
        â”‚  2. Charger produit depuis BDD       â”‚
        â”‚  3. VÃ©rifier stock disponible        â”‚
        â”‚     IF quantite &gt; stock THEN         â”‚
        â”‚        â†’ Message erreur              â”‚
        â”‚     ELSE                             â”‚
        â”‚        â†’ Ajouter au panier (session) â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Panier mis Ã  jour en session        â”‚
        â”‚  Stock non modifiÃ© (rÃ©servÃ©)         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              VALIDATION DE COMMANDE                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Clic &quot;Valider le paiement&quot;          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼ POST /panier/paiement-effectue
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  PanierController::paiementEffectue()â”‚
        â”‚  POUR CHAQUE article du panier       â”‚
        â”‚    1. Charger produit depuis BDD     â”‚
        â”‚    2. VÃ©rifier stock disponible      â”‚
        â”‚       (double vÃ©rification)          â”‚
        â”‚    3. CrÃ©er commande                 â”‚
        â”‚    4. DÃ©crÃ©menter stock              â”‚
        â”‚       produit.decrementStock(qty)    â”‚
        â”‚    5. Sauvegarder en BDD             â”‚
        â”‚  FIN POUR                            â”‚
        â”‚  6. Vider le panier (session)        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Stock mis Ã  jour en BDD             â”‚
        â”‚  Commande enregistrÃ©e                â”‚
        â”‚  Panier vidÃ©                         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
<h3 id="exemple-concret">Exemple Concret</h3>
<p><strong>ScÃ©nario</strong> : Un client commande 3 montres â€œMoss
Airâ€</p>
<ol type="1">
<li><p><strong>Ã‰tat initial</strong> : Produit â€œMoss Airâ€ a 10 en
stock</p></li>
<li><p><strong>Ajout au panier</strong> :</p>
<ul>
<li>Client clique â€œAjouter au panierâ€ avec quantitÃ© = 3</li>
<li>VÃ©rification : <code>3 &lt;= 10</code> âœ… OK</li>
<li>Panier en session : <code>[{productId: 1, quantity: 3}]</code></li>
<li>Stock BDD reste Ã  <strong>10</strong> (non modifiÃ©)</li>
</ul></li>
<li><p><strong>Validation commande</strong> :</p>
<ul>
<li>Client clique â€œValider le paiementâ€</li>
<li>Double vÃ©rification : <code>3 &lt;= 10</code> âœ… OK</li>
<li>CrÃ©ation de la commande en BDD</li>
<li><strong>DÃ©crÃ©mentation</strong> : <code>10 - 3 = 7</code></li>
<li>Stock BDD mis Ã  jour Ã  <strong>7</strong></li>
<li>Panier vidÃ©</li>
</ul></li>
<li><p><strong>RÃ©sultat final</strong> :</p>
<ul>
<li>Stock BDD : <strong>7</strong> (10 - 3)</li>
<li>Commande enregistrÃ©e : 3 montres Moss Air</li>
<li>Panier : vide</li>
</ul></li>
</ol>
<p><strong>Si un autre client tente de commander 8 montres</strong> : -
VÃ©rification : <code>8 &gt; 7</code> âŒ ERREUR - Message : â€œStock
insuffisant ! Seulement 7 disponible(s).â€ - Commande bloquÃ©e</p>
<hr />
<h2 id="sÃ©curitÃ©-points-clÃ©s">19. SÃ©curitÃ© : Points ClÃ©s</h2>
<h3 id="hachage-des-mots-de-passe">1. Hachage des Mots de Passe</h3>
<div class="sourceCode" id="cb49"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Lors de l&#39;inscription</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="va">$hashedPassword</span> <span class="op">=</span> <span class="fu">password_hash</span>(<span class="va">$plainPassword</span><span class="ot">,</span> <span class="cn">PASSWORD_DEFAULT</span>)<span class="ot">;</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Lors de la connexion</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">password_verify</span>(<span class="va">$plainPassword</span><span class="ot">,</span> <span class="va">$hashedPassword</span>)) {</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Mot de passe correct</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Algorithme utilisÃ©</strong> : bcrypt (via
<code>PASSWORD_DEFAULT</code>)</p>
<h3 id="validation-des-entrÃ©es-utilisateur">2. Validation des EntrÃ©es
Utilisateur</h3>
<div class="sourceCode" id="cb50"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Conversion sÃ©curisÃ©e en entier</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="va">$productId</span> <span class="op">=</span> (<span class="dt">int</span>) <span class="va">$request</span>-&gt;request-&gt;get(<span class="st">&#39;product_id&#39;</span>)<span class="ot">;</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co">// VÃ©rification d&#39;existence</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="op">!</span><span class="va">$produit</span>) {</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">throw</span> <span class="va">$this</span>-&gt;createNotFoundException(<span class="st">&#39;Produit introuvable&#39;</span>)<span class="ot">;</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h3 id="protection-csrf">3. Protection CSRF</h3>
<pre class="twig"><code>{# Token CSRF dans les formulaires de suppression #}
&lt;input type=&quot;hidden&quot; name=&quot;_token&quot; value=&quot;{{ csrf_token(&#39;delete&#39; ~ produit.id) }}&quot;&gt;</code></pre>
<div class="sourceCode" id="cb52"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">// VÃ©rification cÃ´tÃ© serveur</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="va">$this</span>-&gt;isCsrfTokenValid(<span class="st">&#39;delete&#39;</span> <span class="op">.</span> <span class="va">$produit</span>-&gt;getId()<span class="ot">,</span> <span class="va">$token</span>)) {</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Suppression autorisÃ©e</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h3 id="contrÃ´le-daccÃ¨s-admin">4. ContrÃ´le dâ€™AccÃ¨s Admin</h3>
<div class="sourceCode" id="cb53"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="kw">private</span> <span class="kw">function</span> checkAdmin(<span class="cn">S</span>essionInterface <span class="va">$session</span>)<span class="ot">:</span> <span class="dt">bool</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    <span class="va">$user</span> <span class="op">=</span> <span class="va">$session</span>-&gt;get(<span class="st">&#39;user&#39;</span>)<span class="ot">;</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">$user</span> <span class="op">&amp;&amp;</span> <span class="kw">isset</span>(<span class="va">$user</span>[<span class="st">&#39;role&#39;</span>]) <span class="op">&amp;&amp;</span> <span class="va">$user</span>[<span class="st">&#39;role&#39;</span>] <span class="op">===</span> <span class="st">&#39;admin&#39;</span><span class="ot">;</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co">// Dans chaque mÃ©thode admin</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="op">!</span><span class="va">$this</span>-&gt;checkAdmin(<span class="va">$session</span>)) {</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>    <span class="va">$this</span>-&gt;addFlash(<span class="st">&#39;error&#39;</span><span class="ot">,</span> <span class="st">&#39;AccÃ¨s refusÃ©&#39;</span>)<span class="ot">;</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">$this</span>-&gt;redirectToRoute(<span class="st">&#39;app_home&#39;</span>)<span class="ot">;</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h3 id="prÃ©vention-des-stocks-nÃ©gatifs">5. PrÃ©vention des Stocks
NÃ©gatifs</h3>
<div class="sourceCode" id="cb54"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Dans Produit::decrementStock()</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">function</span> decrementStock(<span class="dt">int</span> <span class="va">$quantity</span>)<span class="ot">:</span> <span class="kw">static</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// max(0, ...) garantit que le stock ne peut pas Ãªtre nÃ©gatif</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    <span class="va">$this</span>-&gt;stock <span class="op">=</span> <span class="fu">max</span>(<span class="dv">0</span><span class="ot">,</span> <span class="va">$this</span>-&gt;stock <span class="op">-</span> <span class="va">$quantity</span>)<span class="ot">;</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">$this</span><span class="ot">;</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<hr />
<h2 id="utilisation-de-symfony-avantages">20. Utilisation de Symfony :
Avantages</h2>
<h3 id="pourquoi-symfony">Pourquoi Symfony ?</h3>
<ol type="1">
<li><p><strong>Doctrine ORM</strong> : Gestion simplifiÃ©e de la base de
donnÃ©es</p>
<ul>
<li>Entities = objets PHP â†”ï¸ tables SQL</li>
<li>Pas besoin dâ€™Ã©crire du SQL brut</li>
<li>Migrations automatiques</li>
</ul></li>
<li><p><strong>Routing</strong> : URLs propres et sÃ©mantiques</p>
<div class="sourceCode" id="cb55"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span><span class="cn">R</span>oute(<span class="st">&#39;/panier/ajouter&#39;</span><span class="ot">,</span> name<span class="ot">:</span> <span class="st">&#39;app_panier_ajouter&#39;</span>)<span class="at">]</span></span></code></pre></div></li>
<li><p><strong>Twig</strong> : Moteur de templates sÃ©curisÃ©</p>
<ul>
<li>Protection automatique contre XSS</li>
<li>Syntaxe claire et lisible</li>
<li>HÃ©ritage de templates</li>
</ul></li>
<li><p><strong>Formulaires</strong> : Validation automatique</p>
<ul>
<li>Tokens CSRF automatiques</li>
<li>Gestion des erreurs</li>
</ul></li>
<li><p><strong>Sessions</strong> : Gestion simplifiÃ©e</p>
<div class="sourceCode" id="cb56"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="va">$session</span>-&gt;set(<span class="st">&#39;panier&#39;</span><span class="ot">,</span> <span class="va">$panier</span>)<span class="ot">;</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="va">$panier</span> <span class="op">=</span> <span class="va">$session</span>-&gt;get(<span class="st">&#39;panier&#39;</span><span class="ot">,</span> [])<span class="ot">;</span></span></code></pre></div></li>
</ol>
<hr />
<h2 id="structure-du-projet-symfony">21. Structure du Projet
Symfony</h2>
<h3 id="arborescence-du-rÃ©pertoire-src">Arborescence du RÃ©pertoire
<code>src/</code></h3>
<p><strong>Commande utilisÃ©e</strong> : <code>tree src/ -L 2</code> ou
<code>find src/ -maxdepth 2</code></p>
<pre><code>src/
â”œâ”€â”€ Controller/                    # ContrÃ´leurs (logique des routes)
â”‚   â”œâ”€â”€ AdminController.php        # Gestion admin (CRUD produits, stocks)
â”‚   â”œâ”€â”€ AuthController.php         # Authentification (login, register)
â”‚   â”œâ”€â”€ CommandeController.php     # Gestion des commandes
â”‚   â”œâ”€â”€ HistoireController.php     # Page &quot;Histoire&quot;
â”‚   â”œâ”€â”€ PageController.php         # Pages statiques
â”‚   â”œâ”€â”€ PanierController.php       # Gestion du panier et stock
â”‚   â”œâ”€â”€ ProduitController.php      # Affichage des produits
â”‚   â”œâ”€â”€ ProfileController.php      # Profil utilisateur
â”‚   â”œâ”€â”€ SitemapController.php      # Sitemap XML
â”‚   â””â”€â”€ FirebaseExampleController.php  # Exemple Firebase (optionnel)
â”‚
â”œâ”€â”€ Entity/                        # EntitÃ©s Doctrine (modÃ¨les de donnÃ©es)
â”‚   â”œâ”€â”€ Commande.php              # EntitÃ© Commande (historique)
â”‚   â”œâ”€â”€ Produit.php               # EntitÃ© Produit avec champ stock
â”‚   â””â”€â”€ User.php                  # EntitÃ© User (avec rÃ´les)
â”‚
â”œâ”€â”€ Repository/                    # Repositories (requÃªtes BDD)
â”‚   â”œâ”€â”€ CommandeRepository.php    # RequÃªtes pour les commandes
â”‚   â”œâ”€â”€ ProduitRepository.php     # RequÃªtes pour les produits
â”‚   â””â”€â”€ UserRepository.php        # RequÃªtes pour les utilisateurs
â”‚
â”œâ”€â”€ Service/                       # Services (logique mÃ©tier)
â”‚   â”œâ”€â”€ FirebaseAuthService.php   # Authentification Firebase
â”‚   â””â”€â”€ FirebaseStorageService.php # Stockage Firebase
â”‚
â””â”€â”€ Kernel.php                     # Noyau Symfony (configuration)</code></pre>
<p><strong>Points clÃ©s</strong> : - <strong>Controllers</strong> :
Gestion des requÃªtes HTTP et de la logique mÃ©tier -
<strong>Entities</strong> : ReprÃ©sentation PHP des tables de la base de
donnÃ©es - <strong>Repositories</strong> : RequÃªtes personnalisÃ©es pour
accÃ©der aux donnÃ©es - <strong>Services</strong> : FonctionnalitÃ©s
rÃ©utilisables (ex: Firebase, email, etc.)</p>
<hr />
<h3 id="fichiers-de-migrations-doctrine">Fichiers de Migrations
Doctrine</h3>
<p><strong>Commande utilisÃ©e</strong> :
<code>ls -la migrations/</code></p>
<pre><code>migrations/
â”œâ”€â”€ .gitignore
â”œâ”€â”€ Version20251028105658.php     # Migration initiale (crÃ©ation tables user, produit, commande)
â”œâ”€â”€ Version20251121000000.php     # Migration intermÃ©diaire (ajouts/modifications)
â”œâ”€â”€ Version20251128090112.php     # Migration (modifications structure)
â””â”€â”€ Version20251203150000.php     # â­ Migration ajout colonne STOCK</code></pre>
<p><strong>Migration cruciale</strong> :
<code>Version20251203150000.php</code> (Ajout du stock)</p>
<h3 id="contenu-du-fichier-de-migration-stock">ğŸ“„ Contenu du Fichier de
Migration Stock</h3>
<p><strong>Fichier</strong> :
<code>migrations/Version20251203150000.php</code></p>
<div class="sourceCode" id="cb59"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;?php</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="kw">declare</span>(strict_types<span class="op">=</span><span class="dv">1</span>)<span class="ot">;</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> <span class="cn">D</span>octrineMigrations<span class="ot">;</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="cn">D</span>octrine\<span class="cn">DBAL</span>\<span class="cn">S</span>chema\<span class="cn">S</span>chema<span class="ot">;</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="cn">D</span>octrine\<span class="cn">M</span>igrations\<span class="cn">A</span>bstractMigration<span class="ot">;</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="co"> * Migration pour ajouter la colonne &#39;stock&#39; Ã  la table produit</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="co"> *</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="co"> * PRINCIPE :</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a><span class="co"> * - up() = Ajoute la colonne stock (exÃ©cutÃ© lors de php bin/console doctrine:migrations:migrate)</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a><span class="co"> * - down() = Supprime la colonne stock (pour annuler la migration)</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a><span class="kw">final</span> <span class="kw">class</span> <span class="cn">V</span>ersion20251203150000 <span class="kw">extends</span> <span class="cn">A</span>bstractMigration</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">function</span> getDescription()<span class="ot">:</span> <span class="dt">string</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;Ajouter la colonne stock Ã  la table produit pour gÃ©rer les quantitÃ©s disponibles&#39;</span><span class="ot">;</span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">// MÃ©thode exÃ©cutÃ©e pour appliquer la migration</span></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">function</span> up(<span class="cn">S</span>chema <span class="va">$schema</span>)<span class="ot">:</span> <span class="dt">void</span></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Ajouter la colonne &#39;stock&#39; de type INT (nombre entier)</span></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>        <span class="co">// NOT NULL = obligatoire</span></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>        <span class="co">// DEFAULT 0 = valeur par dÃ©faut Ã  0 si aucune valeur n&#39;est fournie</span></span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>        <span class="va">$this</span>-&gt;addSql(<span class="st">&#39;ALTER TABLE produit ADD COLUMN stock INT NOT NULL DEFAULT 0&#39;</span>)<span class="ot">;</span></span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a>    <span class="co">// MÃ©thode exÃ©cutÃ©e pour annuler la migration</span></span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="kw">function</span> down(<span class="cn">S</span>chema <span class="va">$schema</span>)<span class="ot">:</span> <span class="dt">void</span></span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Supprimer la colonne &#39;stock&#39;</span></span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a>        <span class="va">$this</span>-&gt;addSql(<span class="st">&#39;ALTER TABLE produit DROP COLUMN stock&#39;</span>)<span class="ot">;</span></span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Explication dÃ©taillÃ©e</strong> :</p>
<ol type="1">
<li><strong>Classe</strong> : <code>Version20251203150000</code> hÃ©rite
de <code>AbstractMigration</code>
<ul>
<li>Nom basÃ© sur la date : <code>20251203150000</code> = 3 dÃ©cembre 2025
Ã  15h00</li>
</ul></li>
<li><strong>MÃ©thode <code>getDescription()</code></strong> :
<ul>
<li>Description claire de ce que fait la migration</li>
<li>Utile pour la documentation et les logs</li>
</ul></li>
<li><strong>MÃ©thode <code>up()</code></strong> :
<ul>
<li>ExÃ©cutÃ©e quand on lance
<code>php bin/console doctrine:migrations:migrate</code></li>
<li>Ajoute la colonne <code>stock</code> de type <code>INT</code></li>
<li><code>NOT NULL</code> : la colonne ne peut pas Ãªtre vide</li>
<li><code>DEFAULT 0</code> : si aucune valeur nâ€™est spÃ©cifiÃ©e, la valeur
sera 0</li>
</ul></li>
<li><strong>MÃ©thode <code>down()</code></strong> :
<ul>
<li>ExÃ©cutÃ©e quand on annule la migration avec
<code>php bin/console doctrine:migrations:migrate prev</code></li>
<li>Supprime la colonne <code>stock</code></li>
<li>Permet de revenir en arriÃ¨re si nÃ©cessaire</li>
</ul></li>
</ol>
<p><strong>Commandes Symfony pour les migrations</strong> :</p>
<div class="sourceCode" id="cb60"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CrÃ©er une nouvelle migration (gÃ©nÃ¨re automatiquement le fichier)</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="ex">php</span> bin/console make:migration</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Voir le statut des migrations (appliquÃ©es ou non)</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="ex">php</span> bin/console doctrine:migrations:status</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Appliquer toutes les migrations en attente</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="ex">php</span> bin/console doctrine:migrations:migrate</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Annuler la derniÃ¨re migration</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="ex">php</span> bin/console doctrine:migrations:migrate prev</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Voir le SQL qui sera exÃ©cutÃ© sans l&#39;appliquer</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a><span class="ex">php</span> bin/console doctrine:migrations:migrate <span class="at">--dry-run</span></span></code></pre></div>
<p><strong>Workflow typique</strong> :</p>
<ol type="1">
<li>Modifier une Entity (ex: ajouter
<code>private ?int $stock</code>)</li>
<li>GÃ©nÃ©rer la migration :
<code>php bin/console make:migration</code></li>
<li>VÃ©rifier le fichier de migration gÃ©nÃ©rÃ© dans
<code>migrations/</code></li>
<li>Appliquer la migration :
<code>php bin/console doctrine:migrations:migrate</code></li>
<li>La table est modifiÃ©e en base de donnÃ©es</li>
</ol>
<p><strong>Avantages des migrations</strong> : - âœ… Historique complet
des modifications de la BDD - âœ… Versioning : chaque migration a un
numÃ©ro unique - âœ… RÃ©versibilitÃ© : possibilitÃ© de revenir en arriÃ¨re -
âœ… Travail en Ã©quipe : les migrations se partagent via Git - âœ…
Automatisation : pas besoin dâ€™Ã©crire le SQL manuellement</p>
<hr />
<h2 id="conclusion-de-la-section-technique">Conclusion de la Section
Technique</h2>
<p>Ce cahier des charges technique dÃ©montre la mise en place dâ€™un
<strong>systÃ¨me e-commerce complet</strong> avec :</p>
<p>âœ… <strong>Gestion dynamique du stock</strong> : VÃ©rification avant
ajout, dÃ©crÃ©mentation aprÃ¨s commande âœ… <strong>Interface
responsive</strong> : CSS media queries pour mobile/tablette/desktop âœ…
<strong>InteractivitÃ© JavaScript</strong> : Menu hamburger, accÃ¨s admin,
animations âœ… <strong>Architecture Symfony</strong> : MVC, Entities,
Controllers, Templates âœ… <strong>SÃ©curitÃ© renforcÃ©e</strong> : Hachage,
CSRF, validation, contrÃ´le dâ€™accÃ¨s âœ… <strong>Base de donnÃ©es
relationnelle</strong> : MySQL avec Doctrine ORM âœ… <strong>Dashboard
admin</strong> : Gestion complÃ¨te des produits et du stock</p>
<p><strong>Le code prÃ©sentÃ© est fonctionnel, testÃ© et prÃªt pour la
production.</strong></p>
<hr />
<p>ğŸ“¸ <strong>Screenshots demandÃ©s (voir liste complÃ¨te au dÃ©but du
document)</strong></p>
<hr />
<p><em>Document gÃ©nÃ©rÃ© le 04/12/2025 - Projet Moss Air - DÃ©veloppÃ© avec
Symfony 6</em></p>
</body>
</html>
